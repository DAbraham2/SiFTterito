DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652133455200705400
alice
aaa
4cc932aace3ec8eee6c91cd2b9618266
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652133455200705400
alice
aaa
4cc932aace3ec8eee6c91cd2b9618266
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01\x97\x91\x91\xf3\x84\x94\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x86\xe0\xa5(\xdb\xbb\xf6\xc2\xae\xe6`\xa6'nonce b'\x00\x01\x97\x91\x91\xf3\x84\x94'
tk: b'\n\x83\x0e\xca\xc4\x10;0b\x96I4\x90\xd2dD\xb5#\x1b\xd9\xc04b\xd8\x1a\x03j\x13\t>Y\xfd'
encrypted payload: b"=V\xe5\xc0\x81\x08M\xe1\x0c\xea\xf3\x87\xdf?\xcauH^\xbf\xffM\xfcX3\x1e\x9bZ\xb6\x8c\x02'ah\x86\xe8\x88T`\\W8\xfd\xd08\xf7\xaf\x9aP\r\xfc\xe9\x9f\x02a{p\x95\xe7w\x8e\x0fD"
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b"\x86e\x0b\xa6S9\xf7\xa4\xa9\x160<\xbf\xc9\xcc\x98B\xd04\xb0\xf5\xb8\rN\xf0\x17\xb757\x8f\x06\xa3:Y\xcb\xdau\xb2\xcbr\xfdt\xd0\xb8{\xe3\xb3\x00\xbaY\xd3$+\xd8M\x0b\x94\x9d\xb9\x9ez`\xa2\x94\xd5\x81Hf\xf6\xb3\xc9I/,\x8e\xadR\t+aJ\xc8aI\xdd\x9b\x0b\xa9\xa7\x95 \x98D\x10\x02u\x91{\x1d\x95\x85L\x07;r\xf4RqD\x17`\xd6U-\xca\xe4\xbd3p\n\xed\xe8\x05 \xaa(\xf1\xb2.\xe2\n'\x03\x18'\xe14\x99\xff\xfb\xbeb&p\x12\x8b\x85\xb7\x00\x96K\x9a\xde\xbc\xfe\xee\xa8=\x1a\xa7\xc9\x0f_\xa3\xb9B\x9a8q\xfe}\xbb\xc7\xbb\x7f\x9d\x04\x19\r\xd4\xb2C T\xd1\xed\x1a\xdeO)\x89 gd\x0b\xaa\xe2\xec\xa5\x865.\xfa\x84:\x1c%\x15\xa8\x873\x0c\xd7K@\xec\x8d\x9e\xb5\xf4\xeaS\x08.\x0f/\xda\x9d\xde\xfb\xd8s\xb4\x82\x8b\xf4\xb21\x85ahP\xec\xfc\xf78+e\xaa\xb0v\xbc\xda\x88\x84\xa1"
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b"\x01\x00\x00\x00\x01Z\x00\x01\x97\x91\x91\xf3\x84\x94\x00\x00=V\xe5\xc0\x81\x08M\xe1\x0c\xea\xf3\x87\xdf?\xcauH^\xbf\xffM\xfcX3\x1e\x9bZ\xb6\x8c\x02'ah\x86\xe8\x88T`\\W8\xfd\xd08\xf7\xaf\x9aP\r\xfc\xe9\x9f\x02a{p\x95\xe7w\x8e\x0fD\x86\xe0\xa5(\xdb\xbb\xf6\xc2\xae\xe6`\xa6\x86e\x0b\xa6S9\xf7\xa4\xa9\x160<\xbf\xc9\xcc\x98B\xd04\xb0\xf5\xb8\rN\xf0\x17\xb757\x8f\x06\xa3:Y\xcb\xdau\xb2\xcbr\xfdt\xd0\xb8{\xe3\xb3\x00\xbaY\xd3$+\xd8M\x0b\x94\x9d\xb9\x9ez`\xa2\x94\xd5\x81Hf\xf6\xb3\xc9I/,\x8e\xadR\t+aJ\xc8aI\xdd\x9b\x0b\xa9\xa7\x95 \x98D\x10\x02u\x91{\x1d\x95\x85L\x07;r\xf4RqD\x17`\xd6U-\xca\xe4\xbd3p\n\xed\xe8\x05 \xaa(\xf1\xb2.\xe2\n'\x03\x18'\xe14\x99\xff\xfb\xbeb&p\x12\x8b\x85\xb7\x00\x96K\x9a\xde\xbc\xfe\xee\xa8=\x1a\xa7\xc9\x0f_\xa3\xb9B\x9a8q\xfe}\xbb\xc7\xbb\x7f\x9d\x04\x19\r\xd4\xb2C T\xd1\xed\x1a\xdeO)\x89 gd\x0b\xaa\xe2\xec\xa5\x865.\xfa\x84:\x1c%\x15\xa8\x873\x0c\xd7K@\xec\x8d\x9e\xb5\xf4\xeaS\x08.\x0f/\xda\x9d\xde\xfb\xd8s\xb4\x82\x8b\xf4\xb21\x85ahP\xec\xfc\xf78+e\xaa\xb0v\xbc\xda\x88\x84\xa1"
DEBUG:SiFT_MTP:Message from MTP: b"\x01\x00\x00\x00\x01Z\x00\x01\x97\x91\x91\xf3\x84\x94\x00\x00=V\xe5\xc0\x81\x08M\xe1\x0c\xea\xf3\x87\xdf?\xcauH^\xbf\xffM\xfcX3\x1e\x9bZ\xb6\x8c\x02'ah\x86\xe8\x88T`\\W8\xfd\xd08\xf7\xaf\x9aP\r\xfc\xe9\x9f\x02a{p\x95\xe7w\x8e\x0fD\x86\xe0\xa5(\xdb\xbb\xf6\xc2\xae\xe6`\xa6\x86e\x0b\xa6S9\xf7\xa4\xa9\x160<\xbf\xc9\xcc\x98B\xd04\xb0\xf5\xb8\rN\xf0\x17\xb757\x8f\x06\xa3:Y\xcb\xdau\xb2\xcbr\xfdt\xd0\xb8{\xe3\xb3\x00\xbaY\xd3$+\xd8M\x0b\x94\x9d\xb9\x9ez`\xa2\x94\xd5\x81Hf\xf6\xb3\xc9I/,\x8e\xadR\t+aJ\xc8aI\xdd\x9b\x0b\xa9\xa7\x95 \x98D\x10\x02u\x91{\x1d\x95\x85L\x07;r\xf4RqD\x17`\xd6U-\xca\xe4\xbd3p\n\xed\xe8\x05 \xaa(\xf1\xb2.\xe2\n'\x03\x18'\xe14\x99\xff\xfb\xbeb&p\x12\x8b\x85\xb7\x00\x96K\x9a\xde\xbc\xfe\xee\xa8=\x1a\xa7\xc9\x0f_\xa3\xb9B\x9a8q\xfe}\xbb\xc7\xbb\x7f\x9d\x04\x19\r\xd4\xb2C T\xd1\xed\x1a\xdeO)\x89 gd\x0b\xaa\xe2\xec\xa5\x865.\xfa\x84:\x1c%\x15\xa8\x873\x0c\xd7K@\xec\x8d\x9e\xb5\xf4\xeaS\x08.\x0f/\xda\x9d\xde\xfb\xd8s\xb4\x82\x8b\xf4\xb21\x85ahP\xec\xfc\xf78+e\xaa\xb0v\xbc\xda\x88\x84\xa1"
DEBUG:SiFT_MTP:TK from MTP: b'\n\x83\x0e\xca\xc4\x10;0b\x96I4\x90\xd2dD\xb5#\x1b\xd9\xc04b\xd8\x1a\x03j\x13\t>Y\xfd'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 3c0dc75488eacdfd58edadec91613f0f8ff46c46e1db9c3e35d506ce8ae8ec17
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b"\x01\x00\x00\x00\x01Z\x00\x01\x97\x91\x91\xf3\x84\x94\x00\x00=V\xe5\xc0\x81\x08M\xe1\x0c\xea\xf3\x87\xdf?\xcauH^\xbf\xffM\xfcX3\x1e\x9bZ\xb6\x8c\x02'ah\x86\xe8\x88T`\\W8\xfd\xd08\xf7\xaf\x9aP\r\xfc\xe9\x9f\x02a{p\x95\xe7w\x8e\x0fD\x86\xe0\xa5(\xdb\xbb\xf6\xc2\xae\xe6`\xa6\x86e\x0b\xa6S9\xf7\xa4\xa9\x160<\xbf\xc9\xcc\x98B\xd04\xb0\xf5\xb8\rN\xf0\x17\xb757\x8f\x06\xa3:Y\xcb\xdau\xb2\xcbr\xfdt\xd0\xb8{\xe3\xb3\x00\xbaY\xd3$+\xd8M\x0b\x94\x9d\xb9\x9ez`\xa2\x94\xd5\x81Hf\xf6\xb3\xc9I/,\x8e\xadR\t+aJ\xc8aI\xdd\x9b\x0b\xa9\xa7\x95 \x98D\x10\x02u\x91{\x1d\x95\x85L\x07;r\xf4RqD\x17`\xd6U-\xca\xe4\xbd3p\n\xed\xe8\x05 \xaa(\xf1\xb2.\xe2\n'\x03\x18'\xe14\x99\xff\xfb\xbeb&p\x12\x8b\x85\xb7\x00\x96K\x9a\xde\xbc\xfe\xee\xa8=\x1a\xa7\xc9\x0f_\xa3\xb9B\x9a8q\xfe}\xbb\xc7\xbb\x7f\x9d\x04\x19\r\xd4\xb2C T\xd1\xed\x1a\xdeO)\x89 gd\x0b\xaa\xe2\xec\xa5\x865.\xfa\x84:\x1c%\x15\xa8\x873\x0c\xd7K@\xec\x8d\x9e\xb5\xf4\xeaS\x08.\x0f/\xda\x9d\xde\xfb\xd8s\xb4\x82\x8b\xf4\xb21\x85ahP\xec\xfc\xf78+e\xaa\xb0v\xbc\xda\x88\x84\xa1"
Message hash: b'<\r\xc7T\x88\xea\xcd\xfdX\xed\xad\xec\x91a?\x0f\x8f\xf4lF\xe1\xdb\x9c>5\xd5\x06\xce\x8a\xe8\xec\x17'
My random: 4cc932aace3ec8eee6c91cd2b9618266
Temp key: b'\n\x83\x0e\xca\xc4\x10;0b\x96I4\x90\xd2dD\xb5#\x1b\xd9\xc04b\xd8\x1a\x03j\x13\t>Y\xfd'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00\x1b\xb2\xfb\xbc\x84\xb0O\xfa\x13\x8e\xb2g\xf9\x99\x06A\xaf\xde\x13\x8c,\x16\x95\xecgr\x97\n\xa4\x1f\x8d\xc1\x933&\xe9{\xb7\xcd\xaai\x96\xc0\xb0F\xe09\r<\xf1\xc1u\x87\xfd\xed\x93<\xee 3%\xec\xd8Dh\x07\x96\x99,\xad\xe9\xb2\x0c\x12}op*\xc2\xc5$*\x8fx\xcd\xe2\x86\xe5\x0fW\xe4*W\x8e\x19\xc3\x1f\x1f\x7f\xe8\xc1\xfb\xcc\xe6\xb1\xf5\x95\x98\xab'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00\x1b\xb2\xfb\xbc\x84\xb0O\xfa\x13\x8e\xb2g\xf9\x99\x06A\xaf\xde\x13\x8c,\x16\x95\xecgr\x97\n\xa4\x1f\x8d\xc1\x933&\xe9{\xb7\xcd\xaai\x96\xc0\xb0F\xe09\r<\xf1\xc1u\x87\xfd\xed\x93<\xee 3%\xec\xd8Dh\x07\x96\x99,\xad\xe9\xb2\x0c\x12}op*\xc2\xc5$*\x8fx\xcd\xe2\x86\xe5\x0fW\xe4*W\x8e\x19\xc3\x1f\x1f\x7f\xe8\xc1\xfb\xcc\xe6\xb1\xf5\x95\x98\xab'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x1f\x7f\xe8\xc1\xfb\xcc\xe6\xb1\xf5\x95\x98\xab'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'3c0dc75488eacdfd58edadec91613f0f8ff46c46e1db9c3e35d506ce8ae8ec17\ndc7c77b034f25bbc93379c94c2c68e4f'
DEBUG:SiFT_MTP:3c0dc75488eacdfd58edadec91613f0f8ff46c46e1db9c3e35d506ce8ae8ec17
dc7c77b034f25bbc93379c94c2c68e4f
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xd3{#t\x10\x80I0{q38\xdbE\x10\x8c\xd2Taa*\xc2\x1f\xfa,\xac\x84\xed\xa9\x84g\xa7'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xd3{#t\x10\x80I0{q38\xdbE\x10\x8c\xd2Taa*\xc2\x1f\xfa,\xac\x84\xed\xa9\x84g\xa7'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xe8\xec\xbd\xdf\xe6\xd6\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xb7\xec\xef'
MAC: b'\xe0D\xe2F~O[\xa3\x0f#\xae\x8f'nonce b'\x00\x02\xe8\xec\xbd\xdf\xe6\xd6'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02\xe8\xec\xbd\xdf\xe6\xd6\x00\x00\xb7\xec\xef\xe0D\xe2F~O[\xa3\x0f#\xae\x8f'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02\xe8\xec\xbd\xdf\xe6\xd6\x00\x00\xb7\xec\xef\xe0D\xe2F~O[\xa3\x0f#\xae\x8f'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xe8\xec\xbd\xdf\xe6\xd6\x00\x00\xb7\xec\xef\xe0D\xe2F~O[\xa3\x0f#\xae\x8f'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00%G\xe9#\xe4\x11WJ\x90\t\x03 y\xf0\xe6)\x12\x98F\x90\x8c\xbfd\xc6*\xc8\xb6\x96\x8eTg\xe1\xf7\xed\xd5\x9dao(\x07\x92\x0f\\\x9e\x04\xaaM\x0e\x0b\x86\xc0\\w\xb9\x9a:ny\xceQU]\x18N\x1a\xd4c\x87\xf5\xe9\x81C\xcf\xcd6Xi0\\5Ik\xcd%=b\x97\x15\xcb\xd2\x95'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'5Ik\xcd%=b\x97\x15\xcb\xd2\x95'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
ERROR:__main__:An error was occurred during the process: 'list' object has no attribute 'split'
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652133485106588600
alice
aaa
9bbd2ad9aab680507dfe308f4df0e8b4
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652133485106588600
alice
aaa
9bbd2ad9aab680507dfe308f4df0e8b4
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01{\xf94O:^\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\xb4\xbfd\xf0\x16p\x1c\x92\x91\xde\xfa\x02'nonce b'\x00\x01{\xf94O:^'
tk: b'\x8eH\x99\xc2\x8c\xd0\xb1/\n\xee\xf2\xba&S\xeb\xeb\x14\xb6\x95|2\x11\xdb\x85\xb5vd\xc3\x1etU\xe0'
encrypted payload: b'~\x99\x87T\xcb.\xc7NL\xb9\xb41i@\xe8WT\xfe\xdf\xa7&\xdbyi\xbd\x8e\xacj%.WC\xfa\xe3\xe2W\x98\x98\x11\xcb)\xba\x99\x8eL\xcd*\xe3\x87\x01\x89h]<\x88\\\xdf@\xaa\x02!$'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'i\x11\xafT\xb7/b\x89/]\x10:\xbau\xe0"\xcf\xdb!\xe5 \xab<\xccz3\x9c\xf4\xa8,\xdb\t3\x81\xafv\xc6<\xc6\xac2\xde\x04\xe8)]\x14\xf6\x16\x94\xd0\x18\xed\xd5&\x8awY\xa8)\xf9\xe7\xfa\x8c\xbeu\x80\xa7\xf2V\xa7\x11\tb\xef\xb7\x1c\xa1\xc4p\xd4zI\xff)n\xab\xc5/iC\x94\x86[\x14\xcd<\xde\xea\xac\xf1\x875#\x15\xb5\xa6P\xff\xb8\x8b.\x0e\xbc"\x11\x8bk\x18\xce\xe00\xa3$\x98>C\x80\xec\xda\xd5\x9e\xde*\x17\x8di\xe4\x0fy\xa2#\xfa\x96\x1b\x03\xf7\x1a\xe5\x84V\xb1\xcfZ\xa8\xaa\x91\xeaf\xf0\'\x9b\xb4;66\x9e\xbd{\xba\x0c\xfb\xde\xd6\xbdT5qg\x19\xd5\xf1\x97\x7f\x1f\x0b{\xb97\xf7\x92WZp\xc0\x17\x1dy\xc7\xab\x03!\x8b\x15\xfa\xc6:\xd7T\x01Z\xe0\xb1\xc2\x16H\xadpDD\xb0x\xea\xf6c\xefDR\x1ej:\xf0\xa2\x8e\x94\x07\x19~\x1b\xb5\xe9\x16\xde\'\x1d8\x10Hs\x84\xaaZ\x12\xb6p_'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01{\xf94O:^\x00\x00~\x99\x87T\xcb.\xc7NL\xb9\xb41i@\xe8WT\xfe\xdf\xa7&\xdbyi\xbd\x8e\xacj%.WC\xfa\xe3\xe2W\x98\x98\x11\xcb)\xba\x99\x8eL\xcd*\xe3\x87\x01\x89h]<\x88\\\xdf@\xaa\x02!$\xb4\xbfd\xf0\x16p\x1c\x92\x91\xde\xfa\x02i\x11\xafT\xb7/b\x89/]\x10:\xbau\xe0"\xcf\xdb!\xe5 \xab<\xccz3\x9c\xf4\xa8,\xdb\t3\x81\xafv\xc6<\xc6\xac2\xde\x04\xe8)]\x14\xf6\x16\x94\xd0\x18\xed\xd5&\x8awY\xa8)\xf9\xe7\xfa\x8c\xbeu\x80\xa7\xf2V\xa7\x11\tb\xef\xb7\x1c\xa1\xc4p\xd4zI\xff)n\xab\xc5/iC\x94\x86[\x14\xcd<\xde\xea\xac\xf1\x875#\x15\xb5\xa6P\xff\xb8\x8b.\x0e\xbc"\x11\x8bk\x18\xce\xe00\xa3$\x98>C\x80\xec\xda\xd5\x9e\xde*\x17\x8di\xe4\x0fy\xa2#\xfa\x96\x1b\x03\xf7\x1a\xe5\x84V\xb1\xcfZ\xa8\xaa\x91\xeaf\xf0\'\x9b\xb4;66\x9e\xbd{\xba\x0c\xfb\xde\xd6\xbdT5qg\x19\xd5\xf1\x97\x7f\x1f\x0b{\xb97\xf7\x92WZp\xc0\x17\x1dy\xc7\xab\x03!\x8b\x15\xfa\xc6:\xd7T\x01Z\xe0\xb1\xc2\x16H\xadpDD\xb0x\xea\xf6c\xefDR\x1ej:\xf0\xa2\x8e\x94\x07\x19~\x1b\xb5\xe9\x16\xde\'\x1d8\x10Hs\x84\xaaZ\x12\xb6p_'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01{\xf94O:^\x00\x00~\x99\x87T\xcb.\xc7NL\xb9\xb41i@\xe8WT\xfe\xdf\xa7&\xdbyi\xbd\x8e\xacj%.WC\xfa\xe3\xe2W\x98\x98\x11\xcb)\xba\x99\x8eL\xcd*\xe3\x87\x01\x89h]<\x88\\\xdf@\xaa\x02!$\xb4\xbfd\xf0\x16p\x1c\x92\x91\xde\xfa\x02i\x11\xafT\xb7/b\x89/]\x10:\xbau\xe0"\xcf\xdb!\xe5 \xab<\xccz3\x9c\xf4\xa8,\xdb\t3\x81\xafv\xc6<\xc6\xac2\xde\x04\xe8)]\x14\xf6\x16\x94\xd0\x18\xed\xd5&\x8awY\xa8)\xf9\xe7\xfa\x8c\xbeu\x80\xa7\xf2V\xa7\x11\tb\xef\xb7\x1c\xa1\xc4p\xd4zI\xff)n\xab\xc5/iC\x94\x86[\x14\xcd<\xde\xea\xac\xf1\x875#\x15\xb5\xa6P\xff\xb8\x8b.\x0e\xbc"\x11\x8bk\x18\xce\xe00\xa3$\x98>C\x80\xec\xda\xd5\x9e\xde*\x17\x8di\xe4\x0fy\xa2#\xfa\x96\x1b\x03\xf7\x1a\xe5\x84V\xb1\xcfZ\xa8\xaa\x91\xeaf\xf0\'\x9b\xb4;66\x9e\xbd{\xba\x0c\xfb\xde\xd6\xbdT5qg\x19\xd5\xf1\x97\x7f\x1f\x0b{\xb97\xf7\x92WZp\xc0\x17\x1dy\xc7\xab\x03!\x8b\x15\xfa\xc6:\xd7T\x01Z\xe0\xb1\xc2\x16H\xadpDD\xb0x\xea\xf6c\xefDR\x1ej:\xf0\xa2\x8e\x94\x07\x19~\x1b\xb5\xe9\x16\xde\'\x1d8\x10Hs\x84\xaaZ\x12\xb6p_'
DEBUG:SiFT_MTP:TK from MTP: b'\x8eH\x99\xc2\x8c\xd0\xb1/\n\xee\xf2\xba&S\xeb\xeb\x14\xb6\x95|2\x11\xdb\x85\xb5vd\xc3\x1etU\xe0'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 03eb3d4097c2789b6187aee32efc527357770075c30e642fb17caa486dbe5ba6
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01{\xf94O:^\x00\x00~\x99\x87T\xcb.\xc7NL\xb9\xb41i@\xe8WT\xfe\xdf\xa7&\xdbyi\xbd\x8e\xacj%.WC\xfa\xe3\xe2W\x98\x98\x11\xcb)\xba\x99\x8eL\xcd*\xe3\x87\x01\x89h]<\x88\\\xdf@\xaa\x02!$\xb4\xbfd\xf0\x16p\x1c\x92\x91\xde\xfa\x02i\x11\xafT\xb7/b\x89/]\x10:\xbau\xe0"\xcf\xdb!\xe5 \xab<\xccz3\x9c\xf4\xa8,\xdb\t3\x81\xafv\xc6<\xc6\xac2\xde\x04\xe8)]\x14\xf6\x16\x94\xd0\x18\xed\xd5&\x8awY\xa8)\xf9\xe7\xfa\x8c\xbeu\x80\xa7\xf2V\xa7\x11\tb\xef\xb7\x1c\xa1\xc4p\xd4zI\xff)n\xab\xc5/iC\x94\x86[\x14\xcd<\xde\xea\xac\xf1\x875#\x15\xb5\xa6P\xff\xb8\x8b.\x0e\xbc"\x11\x8bk\x18\xce\xe00\xa3$\x98>C\x80\xec\xda\xd5\x9e\xde*\x17\x8di\xe4\x0fy\xa2#\xfa\x96\x1b\x03\xf7\x1a\xe5\x84V\xb1\xcfZ\xa8\xaa\x91\xeaf\xf0\'\x9b\xb4;66\x9e\xbd{\xba\x0c\xfb\xde\xd6\xbdT5qg\x19\xd5\xf1\x97\x7f\x1f\x0b{\xb97\xf7\x92WZp\xc0\x17\x1dy\xc7\xab\x03!\x8b\x15\xfa\xc6:\xd7T\x01Z\xe0\xb1\xc2\x16H\xadpDD\xb0x\xea\xf6c\xefDR\x1ej:\xf0\xa2\x8e\x94\x07\x19~\x1b\xb5\xe9\x16\xde\'\x1d8\x10Hs\x84\xaaZ\x12\xb6p_'
Message hash: b'\x03\xeb=@\x97\xc2x\x9ba\x87\xae\xe3.\xfcRsWw\x00u\xc3\x0ed/\xb1|\xaaHm\xbe[\xa6'
My random: 9bbd2ad9aab680507dfe308f4df0e8b4
Temp key: b'\x8eH\x99\xc2\x8c\xd0\xb1/\n\xee\xf2\xba&S\xeb\xeb\x14\xb6\x95|2\x11\xdb\x85\xb5vd\xc3\x1etU\xe0'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x006\xba\x8a\xabl\xf7QW\x1a\xc5\x8e\x07z/\x96\xead\xde\x94u\xfb*`SZ\x0c \xb9\xa5\xfa\x1dZ\x96\x03\x9b"\x87eC~\xd9L\x81\xa8\x1a\x04\xa9Z\xbb\x84\x83)\x87C\x86\xb8\xfc\xe6|3lG\x98\x9d\x9a\x97\x95\xf9FHQ\x9c\x17\x8bw\xb6B\xad=m\xab\x82\xdd`!u[\x0f\n\xa1\x86\xdb \x01^\x07\x1a`\xa5\xb3`9O\xd2\x1c\xbc\xce\xef\x90'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x006\xba\x8a\xabl\xf7QW\x1a\xc5\x8e\x07z/\x96\xead\xde\x94u\xfb*`SZ\x0c \xb9\xa5\xfa\x1dZ\x96\x03\x9b"\x87eC~\xd9L\x81\xa8\x1a\x04\xa9Z\xbb\x84\x83)\x87C\x86\xb8\xfc\xe6|3lG\x98\x9d\x9a\x97\x95\xf9FHQ\x9c\x17\x8bw\xb6B\xad=m\xab\x82\xdd`!u[\x0f\n\xa1\x86\xdb \x01^\x07\x1a`\xa5\xb3`9O\xd2\x1c\xbc\xce\xef\x90'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'`\xa5\xb3`9O\xd2\x1c\xbc\xce\xef\x90'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'03eb3d4097c2789b6187aee32efc527357770075c30e642fb17caa486dbe5ba6\na2e654a74f6ae8be72e79fc0cf4f5f54'
DEBUG:SiFT_MTP:03eb3d4097c2789b6187aee32efc527357770075c30e642fb17caa486dbe5ba6
a2e654a74f6ae8be72e79fc0cf4f5f54
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xf3\xb3\x17u\xb6\xdc\x97\x99/\xe6\xe2=\xbd\x08\xf0\x95\xfc\xaa\x87aL\xebo\xdb\x11\xd5V4\xda\x88\x1e\xa2'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf3\xb3\x17u\xb6\xdc\x97\x99/\xe6\xe2=\xbd\x08\xf0\x95\xfc\xaa\x87aL\xebo\xdb\x11\xd5V4\xda\x88\x1e\xa2'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xaa\x8b\xad\xaag\x80\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x0b{\x8b'
MAC: b';\xe2\x11G\xf0\r\x94\x87\x0c[Q\x95'nonce b'\x00\x02\xaa\x8b\xad\xaag\x80'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02\xaa\x8b\xad\xaag\x80\x00\x00\x0b{\x8b;\xe2\x11G\xf0\r\x94\x87\x0c[Q\x95'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02\xaa\x8b\xad\xaag\x80\x00\x00\x0b{\x8b;\xe2\x11G\xf0\r\x94\x87\x0c[Q\x95'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xaa\x8b\xad\xaag\x80\x00\x00\x0b{\x8b;\xe2\x11G\xf0\r\x94\x87\x0c[Q\x95'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00\xdfz\xf7\x16A\x80\xd3n\xea\x98Ly8\x17\xfbcp\x1f\xb7\x81\xa3b^h\x15\xd7N\x9d\x13\x82r\xdc\xd5\x9a!\x04H\x81\x85f\xccZ^\x14\xfb_\x00f&\xff\x92Q\xd9\x94\xea|\xe4\xa3\xd9\x80u\xef\xe9\xa2\x07\xc1|\xc1\xfc2\x01\x86\x97\xdbo\xce\xd4i\xcb\x00D\nt%u\xe5ZA\xede\xbb'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x00D\nt%u\xe5ZA\xede\xbb'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf3\xb3\x17u\xb6\xdc\x97\x99/\xe6\xe2=\xbd\x08\xf0\x95\xfc\xaa\x87aL\xebo\xdb\x11\xd5V4\xda\x88\x1e\xa2'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x03_\xc5n\x8d-\x9c\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x89w\xce'
MAC: b"\x8f'\xbaDjo\xd1\t(\xf1\xc8\xb9"nonce b'\x00\x03_\xc5n\x8d-\x9c'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b"\x01\x00\x01\x00\x00\x1f\x00\x03_\xc5n\x8d-\x9c\x00\x00\x89w\xce\x8f'\xbaDjo\xd1\t(\xf1\xc8\xb9"
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b"\x01\x00\x01\x00\x00\x1f\x00\x03_\xc5n\x8d-\x9c\x00\x00\x89w\xce\x8f'\xbaDjo\xd1\t(\xf1\xc8\xb9"
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b"\x01\x00\x01\x00\x00\x1f\x00\x03_\xc5n\x8d-\x9c\x00\x00\x89w\xce\x8f'\xbaDjo\xd1\t(\xf1\xc8\xb9"
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00h\x00\x03e^\xb4\xed\xf8\x04\x00\x00\xfe\xc6_T\xe0\x92\xa4j\x1cd8b\x9bI@\xa7\x9e\xbb\x7fm\xb4T8\xdcc"\x8e\xaa9\xc7J\xd1\xe3\x93\x90\x04\xbe\x11"\xad\x1e\x8c\xdc\xdf.\xce\x01:\xf9#Jd\xfe\xb91FN\xea1\xaaxe\xf7\\f\xb51\x8d\x91>\t)7\xd0e\xbe\xdc\xa8\xad\xcc\xfe\xab6\xf4{\xccb\x1e'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00h\x00\x03e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xdc\xa8\xad\xcc\xfe\xab6\xf4{\xccb\x1e'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652133523507753400
alice
aaa
b5332d5fec63cc45f053d6408216bce0
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652133523507753400
alice
aaa
b5332d5fec63cc45f053d6408216bce0
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01\xd3 6]o\xdd\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x9c6\x00\xdb\xce\x18\x88\xf3\xb2q\xd82'nonce b'\x00\x01\xd3 6]o\xdd'
tk: b'\x84_xP\x14\xa8\xe2R\xefC~\xa9\xb3\xf7)\xf9\x14\x8ffZL|\x8a\x9bJ\x0c\xc8\x14\xf7\xef\x81\xa1'
encrypted payload: b'\xa0\xb5\x95GOc\xd3\xea\xccg\r@X6\x9d\x01\n_P\xed\x08\x8b\x7f\xa2\x11K\xa3\xd6O\xb6\xe0\xe0\xa2\x83\x0c\xd8\xe9\x107\xa0 \x1d\x7f].\x82I\xf3q[\x0c\xfa!\x84\x8b\x08j 7G\x95\n'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b']w\xdb\x01d\x9fs2<\xbe\xad\xef\xd9?\xa3\xa6\tXy\xde\xdc\xfb\xb8\xc8E\xaf\xe3\xe9,\x99\xaak\xd8/\xad\xd7\x19\xa3j\xf0\xb3vj?6\xa7\xee\xa8p4\x95&\xba\x12\x10\xb6\x96\x95\xebW\n0M(\x8b\x02\x9b\xa8\xdcD\xa8\xf6\xaf\xd8\xe3\x0f/\x1cy\xeaC\xb3H"\xf6\x1d\x02L\xa8\xb9\x92#\xc6vSY\x8e*Br\xba\xb7\x00tjr\xc9\x97\x95\x8d\xb8\xde\xbc\x18\xf0%\xddq\xc6\x84\x1f{oy\x11{BS\xf0]\x12s+\x9d\xb0\xd3o\x16\xef\xcd\xb4\x00\xdb\xfe\xa5[.WAP\xb3Y\xf2\xfd\xf9|\x93\x87{m\x1dBp\x7f\xb4\xea$\xd1\x808O\xe7\xe2\xbaF\xb8\x15\xdaJI\xd3\x93$\x07u\xecz\xd5\x16XH\xf56\x0f\xa0\xba\xe7\xfd\x81\x16\x18\xf3f\xe7{\x0f\xaf\xc2\xc9\x1d\x87\x0e\xde\x1b\xa9\xb3\xe3\x02<\x869#\x16\xb6\xb7\x9cQ\x0c\xa8n\xc4E4\x18\xa6\xdd1\xeai+\xb2\xa0\x1e\x19\xb4\x18\xd0k(\x08\xa1\xc8\xcd\x05cI'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01\xd3 6]o\xdd\x00\x00\xa0\xb5\x95GOc\xd3\xea\xccg\r@X6\x9d\x01\n_P\xed\x08\x8b\x7f\xa2\x11K\xa3\xd6O\xb6\xe0\xe0\xa2\x83\x0c\xd8\xe9\x107\xa0 \x1d\x7f].\x82I\xf3q[\x0c\xfa!\x84\x8b\x08j 7G\x95\n\x9c6\x00\xdb\xce\x18\x88\xf3\xb2q\xd82]w\xdb\x01d\x9fs2<\xbe\xad\xef\xd9?\xa3\xa6\tXy\xde\xdc\xfb\xb8\xc8E\xaf\xe3\xe9,\x99\xaak\xd8/\xad\xd7\x19\xa3j\xf0\xb3vj?6\xa7\xee\xa8p4\x95&\xba\x12\x10\xb6\x96\x95\xebW\n0M(\x8b\x02\x9b\xa8\xdcD\xa8\xf6\xaf\xd8\xe3\x0f/\x1cy\xeaC\xb3H"\xf6\x1d\x02L\xa8\xb9\x92#\xc6vSY\x8e*Br\xba\xb7\x00tjr\xc9\x97\x95\x8d\xb8\xde\xbc\x18\xf0%\xddq\xc6\x84\x1f{oy\x11{BS\xf0]\x12s+\x9d\xb0\xd3o\x16\xef\xcd\xb4\x00\xdb\xfe\xa5[.WAP\xb3Y\xf2\xfd\xf9|\x93\x87{m\x1dBp\x7f\xb4\xea$\xd1\x808O\xe7\xe2\xbaF\xb8\x15\xdaJI\xd3\x93$\x07u\xecz\xd5\x16XH\xf56\x0f\xa0\xba\xe7\xfd\x81\x16\x18\xf3f\xe7{\x0f\xaf\xc2\xc9\x1d\x87\x0e\xde\x1b\xa9\xb3\xe3\x02<\x869#\x16\xb6\xb7\x9cQ\x0c\xa8n\xc4E4\x18\xa6\xdd1\xeai+\xb2\xa0\x1e\x19\xb4\x18\xd0k(\x08\xa1\xc8\xcd\x05cI'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01\xd3 6]o\xdd\x00\x00\xa0\xb5\x95GOc\xd3\xea\xccg\r@X6\x9d\x01\n_P\xed\x08\x8b\x7f\xa2\x11K\xa3\xd6O\xb6\xe0\xe0\xa2\x83\x0c\xd8\xe9\x107\xa0 \x1d\x7f].\x82I\xf3q[\x0c\xfa!\x84\x8b\x08j 7G\x95\n\x9c6\x00\xdb\xce\x18\x88\xf3\xb2q\xd82]w\xdb\x01d\x9fs2<\xbe\xad\xef\xd9?\xa3\xa6\tXy\xde\xdc\xfb\xb8\xc8E\xaf\xe3\xe9,\x99\xaak\xd8/\xad\xd7\x19\xa3j\xf0\xb3vj?6\xa7\xee\xa8p4\x95&\xba\x12\x10\xb6\x96\x95\xebW\n0M(\x8b\x02\x9b\xa8\xdcD\xa8\xf6\xaf\xd8\xe3\x0f/\x1cy\xeaC\xb3H"\xf6\x1d\x02L\xa8\xb9\x92#\xc6vSY\x8e*Br\xba\xb7\x00tjr\xc9\x97\x95\x8d\xb8\xde\xbc\x18\xf0%\xddq\xc6\x84\x1f{oy\x11{BS\xf0]\x12s+\x9d\xb0\xd3o\x16\xef\xcd\xb4\x00\xdb\xfe\xa5[.WAP\xb3Y\xf2\xfd\xf9|\x93\x87{m\x1dBp\x7f\xb4\xea$\xd1\x808O\xe7\xe2\xbaF\xb8\x15\xdaJI\xd3\x93$\x07u\xecz\xd5\x16XH\xf56\x0f\xa0\xba\xe7\xfd\x81\x16\x18\xf3f\xe7{\x0f\xaf\xc2\xc9\x1d\x87\x0e\xde\x1b\xa9\xb3\xe3\x02<\x869#\x16\xb6\xb7\x9cQ\x0c\xa8n\xc4E4\x18\xa6\xdd1\xeai+\xb2\xa0\x1e\x19\xb4\x18\xd0k(\x08\xa1\xc8\xcd\x05cI'
DEBUG:SiFT_MTP:TK from MTP: b'\x84_xP\x14\xa8\xe2R\xefC~\xa9\xb3\xf7)\xf9\x14\x8ffZL|\x8a\x9bJ\x0c\xc8\x14\xf7\xef\x81\xa1'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: e52351017eeb722e043eea31bf32574cc6515c17f75f62094f6113f6a87bb94c
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01\xd3 6]o\xdd\x00\x00\xa0\xb5\x95GOc\xd3\xea\xccg\r@X6\x9d\x01\n_P\xed\x08\x8b\x7f\xa2\x11K\xa3\xd6O\xb6\xe0\xe0\xa2\x83\x0c\xd8\xe9\x107\xa0 \x1d\x7f].\x82I\xf3q[\x0c\xfa!\x84\x8b\x08j 7G\x95\n\x9c6\x00\xdb\xce\x18\x88\xf3\xb2q\xd82]w\xdb\x01d\x9fs2<\xbe\xad\xef\xd9?\xa3\xa6\tXy\xde\xdc\xfb\xb8\xc8E\xaf\xe3\xe9,\x99\xaak\xd8/\xad\xd7\x19\xa3j\xf0\xb3vj?6\xa7\xee\xa8p4\x95&\xba\x12\x10\xb6\x96\x95\xebW\n0M(\x8b\x02\x9b\xa8\xdcD\xa8\xf6\xaf\xd8\xe3\x0f/\x1cy\xeaC\xb3H"\xf6\x1d\x02L\xa8\xb9\x92#\xc6vSY\x8e*Br\xba\xb7\x00tjr\xc9\x97\x95\x8d\xb8\xde\xbc\x18\xf0%\xddq\xc6\x84\x1f{oy\x11{BS\xf0]\x12s+\x9d\xb0\xd3o\x16\xef\xcd\xb4\x00\xdb\xfe\xa5[.WAP\xb3Y\xf2\xfd\xf9|\x93\x87{m\x1dBp\x7f\xb4\xea$\xd1\x808O\xe7\xe2\xbaF\xb8\x15\xdaJI\xd3\x93$\x07u\xecz\xd5\x16XH\xf56\x0f\xa0\xba\xe7\xfd\x81\x16\x18\xf3f\xe7{\x0f\xaf\xc2\xc9\x1d\x87\x0e\xde\x1b\xa9\xb3\xe3\x02<\x869#\x16\xb6\xb7\x9cQ\x0c\xa8n\xc4E4\x18\xa6\xdd1\xeai+\xb2\xa0\x1e\x19\xb4\x18\xd0k(\x08\xa1\xc8\xcd\x05cI'
Message hash: b'\xe5#Q\x01~\xebr.\x04>\xea1\xbf2WL\xc6Q\\\x17\xf7_b\tOa\x13\xf6\xa8{\xb9L'
My random: b5332d5fec63cc45f053d6408216bce0
Temp key: b'\x84_xP\x14\xa8\xe2R\xefC~\xa9\xb3\xf7)\xf9\x14\x8ffZL|\x8a\x9bJ\x0c\xc8\x14\xf7\xef\x81\xa1'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00K\xb9y\'AZX\xa1\xcf\xf7\x12-\xedK\x86C\xe6P)\x9e\xd4\xda9&\xbf\xc8\x01\xf5?\x888\x07\xe0\'%FM\xf9I\xadNn\xfb\xbc\xb8\xbd\x8a\xa8\x9ay\x99:y\x9c\xf1.w\x00y\xf4!\xbct\\\x0e\x93\xc1\x0f\x1b\x15l\x8cG|L\xac\x90\x15\xb8D\xc1?5\xf9oQ\x13\xe3\xba\xb6\x92P\x04\xc1bR"\xf7\xf6C<e\xa5\xbd\xba \xd8\x18M'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00K\xb9y\'AZX\xa1\xcf\xf7\x12-\xedK\x86C\xe6P)\x9e\xd4\xda9&\xbf\xc8\x01\xf5?\x888\x07\xe0\'%FM\xf9I\xadNn\xfb\xbc\xb8\xbd\x8a\xa8\x9ay\x99:y\x9c\xf1.w\x00y\xf4!\xbct\\\x0e\x93\xc1\x0f\x1b\x15l\x8cG|L\xac\x90\x15\xb8D\xc1?5\xf9oQ\x13\xe3\xba\xb6\x92P\x04\xc1bR"\xf7\xf6C<e\xa5\xbd\xba \xd8\x18M'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01r\xab-\x98\xe7\xf8\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xf7\xf6C<e\xa5\xbd\xba \xd8\x18M'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'e52351017eeb722e043eea31bf32574cc6515c17f75f62094f6113f6a87bb94c\n326212fb6ade431c2817954bcb936c3a'
DEBUG:SiFT_MTP:e52351017eeb722e043eea31bf32574cc6515c17f75f62094f6113f6a87bb94c
326212fb6ade431c2817954bcb936c3a
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b';\xc0\xd0\xd8C\\\xfb\xda\xcb\xbeO[\x18\t\xb5\x00hL\x05X\x1e\x06\xc5\x08\xecn\x94d\xfbr\xc6\x0c'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b';\xc0\xd0\xd8C\\\xfb\xda\xcb\xbeO[\x18\t\xb5\x00hL\x05X\x1e\x06\xc5\x08\xecn\x94d\xfbr\xc6\x0c'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02r3\xe3U\xd6L\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xaf\xbf\x89'
MAC: b'\x08\x01O\x89db- yP"\x05'nonce b'\x00\x02r3\xe3U\xd6L'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02r3\xe3U\xd6L\x00\x00\xaf\xbf\x89\x08\x01O\x89db- yP"\x05'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02r3\xe3U\xd6L\x00\x00\xaf\xbf\x89\x08\x01O\x89db- yP"\x05'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02r3\xe3U\xd6L\x00\x00\xaf\xbf\x89\x08\x01O\x89db- yP"\x05'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00[\x80S\xaaT\xea\x8ef\xa3\x0b\x9f\xe7H$f2\x9e\x8e\xe3\xe2=\r\xfe\x9c\xe6g\xc9s\xfa`\xc9\xe2\x8c=\x9e\xb4\x03\xd2&\xc7\xd0:f\xa3\x99\xfa\x15\x9d\xe87\x92\xcc\x86\xd3AX\xaa\xc9-\x9f\xcdk\xe8/t\xd1\x94\xa2\xda\x85p\xf4\xedj\xd7\xb7$p\xaeUj\x8c\x85\x86\xd5\xcc;7.-\xe7'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'Uj\x8c\x85\x86\xd5\xcc;7.-\xe7'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b';\xc0\xd0\xd8C\\\xfb\xda\xcb\xbeO[\x18\t\xb5\x00hL\x05X\x1e\x06\xc5\x08\xecn\x94d\xfbr\xc6\x0c'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x03\r\x1e\x872\xaa,\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xbdZ{'
MAC: b'B\x88\xb1\x01\x82\x0cf0w]\xb5`'nonce b'\x00\x03\r\x1e\x872\xaa,'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x03\r\x1e\x872\xaa,\x00\x00\xbdZ{B\x88\xb1\x01\x82\x0cf0w]\xb5`'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x03\r\x1e\x872\xaa,\x00\x00\xbdZ{B\x88\xb1\x01\x82\x0cf0w]\xb5`'
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x03\r\x1e\x872\xaa,\x00\x00\xbdZ{B\x88\xb1\x01\x82\x0cf0w]\xb5`'
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00h\x00\x03e^\xb4\xed\xf8\x04\x00\x00\x80\x8d.$[\xf2*c\x16\xbb\xfb7d\x13=\x9f\xe9\x7f!\xa8\x8bF\xb3\x8f\xd0>aC.\x93\xf5\xb1\x05= 7\xea~\xad\xc7dlF\xa7\x9c\xb2E\x1d./]SD\x91}\xe5>v#;\xc2L\xc20\xa1x=\xafVB-\x19\xd1i\xf9\xf78\x82\xdb\xdd\x12N\x92\xc7y\xa4\xf2['
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00h\x00\x03e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'8\x82\xdb\xdd\x12N\x92\xc7y\xa4\xf2['
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b';\xc0\xd0\xd8C\\\xfb\xda\xcb\xbeO[\x18\t\xb5\x00hL\x05X\x1e\x06\xc5\x08\xecn\x94d\xfbr\xc6\x0c'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x04\xe1$9\xc5\x11\xc8\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xd73\xa6'
MAC: b'\xbfc\xa9\x8e\x96r\x82%J\x94f\x80'nonce b'\x00\x04\xe1$9\xc5\x11\xc8'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x04\xe1$9\xc5\x11\xc8\x00\x00\xd73\xa6\xbfc\xa9\x8e\x96r\x82%J\x94f\x80'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x04\xe1$9\xc5\x11\xc8\x00\x00\xd73\xa6\xbfc\xa9\x8e\x96r\x82%J\x94f\x80'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x04\xe1$9\xc5\x11\xc8\x00\x00\xd73\xa6\xbfc\xa9\x8e\x96r\x82%J\x94f\x80'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x04e^\xb4\xed\xf8\x04\x00\x00\x05\x14r\xf2L\xfdr\x91_\x90\xdc\x8e\x89*$\x02\xe6\xec\x08I\xc5\xf1\xf5\xcf\xf2\x0f\xfaR\xf6{\xb7\xe6\x9a\xba\xc3\xd5`-\x02lW*\x94E \x91\xc5\x7f\x18\xcc\xf5\x0e\xd1\x0e\xe4\x99\xc0\xfcw\x10X\xf0\xbe\x98\xa7\x92\xd64\xc5\xaf\xb5\xc8\x18\x08\xdd\xc0\x1d\xebZ\xb6\x97\xban\xc1\xaf\xb4-\rb\xd3\x11'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x04e^\xb4\xed\xf8\x04\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xb6\x97\xban\xc1\xaf\xb4-\rb\xd3\x11'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b';\xc0\xd0\xd8C\\\xfb\xda\xcb\xbeO[\x18\t\xb5\x00hL\x05X\x1e\x06\xc5\x08\xecn\x94d\xfbr\xc6\x0c'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00$'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00$\x00\x05R\xf6\xe6\xc8*\xa0\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x99\x95\xf4K\x813>1'
MAC: b'\x11\x80\xd3\xda|\xa0Q\xfe\x0c\xd7\x97\xc4'nonce b'\x00\x05R\xf6\xe6\xc8*\xa0'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00$\x00\x05R\xf6\xe6\xc8*\xa0\x00\x00\x99\x95\xf4K\x813>1\x11\x80\xd3\xda|\xa0Q\xfe\x0c\xd7\x97\xc4'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
DEBUG:__main__:SQN: b'\x00\x05'
Request message: b'\x01\x00\x01\x00\x00$\x00\x05R\xf6\xe6\xc8*\xa0\x00\x00\x99\x95\xf4K\x813>1\x11\x80\xd3\xda|\xa0Q\xfe\x0c\xd7\x97\xc4'
Message hash: b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'

DEBUG:__main__:b'\x01\x00\x01\x00\x00$\x00\x05R\xf6\xe6\xc8*\xa0\x00\x00\x99\x95\xf4K\x813>1\x11\x80\xd3\xda|\xa0Q\xfe\x0c\xd7\x97\xc4'
DEBUG:__main__:b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b''
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b''
INFO:SiFT_MTP:check_version
DEBUG:SiFT_MTP:Header version is not matching:
Expected: b'\x01\x00'
Message header version: b''
ERROR:__main__:An error was occurred during the process: 'NoneType' object has no attribute 'decode'
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652133853803494800
alice
aaa
a868512a13d2dd620dec5c6bfa35021b
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652133853803494800
alice
aaa
a868512a13d2dd620dec5c6bfa35021b
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01k\xf9\x88\x1a\xca\xf1\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'(NQ\xd3\xc9\x17\xdbwh\x1f)\xf5'nonce b'\x00\x01k\xf9\x88\x1a\xca\xf1'
tk: b'IA\xcc\x92\x9b` G\x0e\x8a\x91\x7f1\xfa\xf9\xc8\xc4\xe73xM\xf8\xc9#\xa4N9\xd1t\xce\xde\x01'
encrypted payload: b"*Z^\xb7\xe2\x19=\x8c\xd3\xfa\xef$i\xb2\xd0\xec\xbeB\xe4\xc7'\xc5\xed\xcd\xe9\xa1}\xfa\x13\xd1\xdf\x04\x98\x02\x16{\xd9T\xde,\x0f\xea.\xd5\x9fc\xf2=\xfe\x00\x12\xcc&\xea\xf2&\x03\xce\x02\xd3\xfev"
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b"\x19\xa6\x83J\xad\x1d.U\xd7\xc3N\xd7\x18\xf9\xe3\x1a_\xc7\x0f\x86?\xcbA'\x99\xf0\xe3\xfc\xf9p\xf9\xb0\xe8&d\xa9\xf8\xb4\xf8\xc3\x12\xf9\xf5\xe6\xd3\xf2\xa6\xb6o\xf0J\x17\x02\xddp\xffd\xc6\x82\x8d\xbb\xbb\xa1DW}60\xc9;;\x90e\xc2\xacA\xac:\x90\x1b1\x9aT\x95\xfb\x1f\x04\xcb\xbb\xf0\x86\x94\xec\x02p\xe1\xe6\x156W\xb7\x91\x93l\x1f\xfb\x9e\xc9v\xb5\xec\xc9\xe3\xfb\xcd\xe9.\xe8%D\x90/\x00O!\x9f\xe8\x0e\xcfm\x14\x06\xce\\\x93\x1cA\xdd\xc4i6\xb62\xdb\xe9nb\xf1+\xf04\xc9;\xba\x86\xd75A~Osd\xff\x0c.\xe2\xe5\xa2$\x96m\x17H\x9f!\xad\xa2\x0ba\xdav`K\xe9Y\n\xc6Pe \x15\x0e;\x99\xceQ\xe1\xd6\x177\xef\xee\x1e\xc8\x898\xca\x97\xb0\xe1\x8c\x93I*\x8c\x9eg\xe6[\xd4+\xccO\xd1\x1a\xab%\xf3\xd2\xb7`\xa5&\x19\x92\x8b3kP\xb3\x91[\xd2\xa0\xae?\xab)j\x85\xca=\xe6\x00\xde\xee"
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b"\x01\x00\x00\x00\x01Z\x00\x01k\xf9\x88\x1a\xca\xf1\x00\x00*Z^\xb7\xe2\x19=\x8c\xd3\xfa\xef$i\xb2\xd0\xec\xbeB\xe4\xc7'\xc5\xed\xcd\xe9\xa1}\xfa\x13\xd1\xdf\x04\x98\x02\x16{\xd9T\xde,\x0f\xea.\xd5\x9fc\xf2=\xfe\x00\x12\xcc&\xea\xf2&\x03\xce\x02\xd3\xfev(NQ\xd3\xc9\x17\xdbwh\x1f)\xf5\x19\xa6\x83J\xad\x1d.U\xd7\xc3N\xd7\x18\xf9\xe3\x1a_\xc7\x0f\x86?\xcbA'\x99\xf0\xe3\xfc\xf9p\xf9\xb0\xe8&d\xa9\xf8\xb4\xf8\xc3\x12\xf9\xf5\xe6\xd3\xf2\xa6\xb6o\xf0J\x17\x02\xddp\xffd\xc6\x82\x8d\xbb\xbb\xa1DW}60\xc9;;\x90e\xc2\xacA\xac:\x90\x1b1\x9aT\x95\xfb\x1f\x04\xcb\xbb\xf0\x86\x94\xec\x02p\xe1\xe6\x156W\xb7\x91\x93l\x1f\xfb\x9e\xc9v\xb5\xec\xc9\xe3\xfb\xcd\xe9.\xe8%D\x90/\x00O!\x9f\xe8\x0e\xcfm\x14\x06\xce\\\x93\x1cA\xdd\xc4i6\xb62\xdb\xe9nb\xf1+\xf04\xc9;\xba\x86\xd75A~Osd\xff\x0c.\xe2\xe5\xa2$\x96m\x17H\x9f!\xad\xa2\x0ba\xdav`K\xe9Y\n\xc6Pe \x15\x0e;\x99\xceQ\xe1\xd6\x177\xef\xee\x1e\xc8\x898\xca\x97\xb0\xe1\x8c\x93I*\x8c\x9eg\xe6[\xd4+\xccO\xd1\x1a\xab%\xf3\xd2\xb7`\xa5&\x19\x92\x8b3kP\xb3\x91[\xd2\xa0\xae?\xab)j\x85\xca=\xe6\x00\xde\xee"
DEBUG:SiFT_MTP:Message from MTP: b"\x01\x00\x00\x00\x01Z\x00\x01k\xf9\x88\x1a\xca\xf1\x00\x00*Z^\xb7\xe2\x19=\x8c\xd3\xfa\xef$i\xb2\xd0\xec\xbeB\xe4\xc7'\xc5\xed\xcd\xe9\xa1}\xfa\x13\xd1\xdf\x04\x98\x02\x16{\xd9T\xde,\x0f\xea.\xd5\x9fc\xf2=\xfe\x00\x12\xcc&\xea\xf2&\x03\xce\x02\xd3\xfev(NQ\xd3\xc9\x17\xdbwh\x1f)\xf5\x19\xa6\x83J\xad\x1d.U\xd7\xc3N\xd7\x18\xf9\xe3\x1a_\xc7\x0f\x86?\xcbA'\x99\xf0\xe3\xfc\xf9p\xf9\xb0\xe8&d\xa9\xf8\xb4\xf8\xc3\x12\xf9\xf5\xe6\xd3\xf2\xa6\xb6o\xf0J\x17\x02\xddp\xffd\xc6\x82\x8d\xbb\xbb\xa1DW}60\xc9;;\x90e\xc2\xacA\xac:\x90\x1b1\x9aT\x95\xfb\x1f\x04\xcb\xbb\xf0\x86\x94\xec\x02p\xe1\xe6\x156W\xb7\x91\x93l\x1f\xfb\x9e\xc9v\xb5\xec\xc9\xe3\xfb\xcd\xe9.\xe8%D\x90/\x00O!\x9f\xe8\x0e\xcfm\x14\x06\xce\\\x93\x1cA\xdd\xc4i6\xb62\xdb\xe9nb\xf1+\xf04\xc9;\xba\x86\xd75A~Osd\xff\x0c.\xe2\xe5\xa2$\x96m\x17H\x9f!\xad\xa2\x0ba\xdav`K\xe9Y\n\xc6Pe \x15\x0e;\x99\xceQ\xe1\xd6\x177\xef\xee\x1e\xc8\x898\xca\x97\xb0\xe1\x8c\x93I*\x8c\x9eg\xe6[\xd4+\xccO\xd1\x1a\xab%\xf3\xd2\xb7`\xa5&\x19\x92\x8b3kP\xb3\x91[\xd2\xa0\xae?\xab)j\x85\xca=\xe6\x00\xde\xee"
DEBUG:SiFT_MTP:TK from MTP: b'IA\xcc\x92\x9b` G\x0e\x8a\x91\x7f1\xfa\xf9\xc8\xc4\xe73xM\xf8\xc9#\xa4N9\xd1t\xce\xde\x01'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 2788034dc0d1fa9476c1df899916b02485c2df7e132855a30da9cf6c8110ae47
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b"\x01\x00\x00\x00\x01Z\x00\x01k\xf9\x88\x1a\xca\xf1\x00\x00*Z^\xb7\xe2\x19=\x8c\xd3\xfa\xef$i\xb2\xd0\xec\xbeB\xe4\xc7'\xc5\xed\xcd\xe9\xa1}\xfa\x13\xd1\xdf\x04\x98\x02\x16{\xd9T\xde,\x0f\xea.\xd5\x9fc\xf2=\xfe\x00\x12\xcc&\xea\xf2&\x03\xce\x02\xd3\xfev(NQ\xd3\xc9\x17\xdbwh\x1f)\xf5\x19\xa6\x83J\xad\x1d.U\xd7\xc3N\xd7\x18\xf9\xe3\x1a_\xc7\x0f\x86?\xcbA'\x99\xf0\xe3\xfc\xf9p\xf9\xb0\xe8&d\xa9\xf8\xb4\xf8\xc3\x12\xf9\xf5\xe6\xd3\xf2\xa6\xb6o\xf0J\x17\x02\xddp\xffd\xc6\x82\x8d\xbb\xbb\xa1DW}60\xc9;;\x90e\xc2\xacA\xac:\x90\x1b1\x9aT\x95\xfb\x1f\x04\xcb\xbb\xf0\x86\x94\xec\x02p\xe1\xe6\x156W\xb7\x91\x93l\x1f\xfb\x9e\xc9v\xb5\xec\xc9\xe3\xfb\xcd\xe9.\xe8%D\x90/\x00O!\x9f\xe8\x0e\xcfm\x14\x06\xce\\\x93\x1cA\xdd\xc4i6\xb62\xdb\xe9nb\xf1+\xf04\xc9;\xba\x86\xd75A~Osd\xff\x0c.\xe2\xe5\xa2$\x96m\x17H\x9f!\xad\xa2\x0ba\xdav`K\xe9Y\n\xc6Pe \x15\x0e;\x99\xceQ\xe1\xd6\x177\xef\xee\x1e\xc8\x898\xca\x97\xb0\xe1\x8c\x93I*\x8c\x9eg\xe6[\xd4+\xccO\xd1\x1a\xab%\xf3\xd2\xb7`\xa5&\x19\x92\x8b3kP\xb3\x91[\xd2\xa0\xae?\xab)j\x85\xca=\xe6\x00\xde\xee"
Message hash: b"'\x88\x03M\xc0\xd1\xfa\x94v\xc1\xdf\x89\x99\x16\xb0$\x85\xc2\xdf~\x13(U\xa3\r\xa9\xcfl\x81\x10\xaeG"
My random: a868512a13d2dd620dec5c6bfa35021b
Temp key: b'IA\xcc\x92\x9b` G\x0e\x8a\x91\x7f1\xfa\xf9\xc8\xc4\xe73xM\xf8\xc9#\xa4N9\xd1t\xce\xde\x01'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00\x07[\xbe\xab\xf1E\x95\xe4\x87|\xe0\x8d\xab\xb7\xab\xba\x01\xd5g\xc8\x9c5\xd9\xcd\x01\'C\xf0\xd4OX\\\x80\xaclX_\xf0^\x89\xf8j\xd9h|\x11\xc6\xabA\x19\xf3\xb4i\xf8\x99\x18\xb3\x12\x19 \xf5\x90&;1o\x93\xf8f\x93\x0c\xee\xf9\xcbI"y\xe0\x11\xbc<\x04\xf4\xb0w\xaar\xee\x9a\x03\xea\xe7\xed\xfe\xab\x17A\xa8\xed\xbdM~\x9b\xc7\x98(B>\xec'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00\x07[\xbe\xab\xf1E\x95\xe4\x87|\xe0\x8d\xab\xb7\xab\xba\x01\xd5g\xc8\x9c5\xd9\xcd\x01\'C\xf0\xd4OX\\\x80\xaclX_\xf0^\x89\xf8j\xd9h|\x11\xc6\xabA\x19\xf3\xb4i\xf8\x99\x18\xb3\x12\x19 \xf5\x90&;1o\x93\xf8f\x93\x0c\xee\xf9\xcbI"y\xe0\x11\xbc<\x04\xf4\xb0w\xaar\xee\x9a\x03\xea\xe7\xed\xfe\xab\x17A\xa8\xed\xbdM~\x9b\xc7\x98(B>\xec'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xa8\xed\xbdM~\x9b\xc7\x98(B>\xec'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'2788034dc0d1fa9476c1df899916b02485c2df7e132855a30da9cf6c8110ae47\nede7ba5177e15513fb66c1c03f27edf4'
DEBUG:SiFT_MTP:2788034dc0d1fa9476c1df899916b02485c2df7e132855a30da9cf6c8110ae47
ede7ba5177e15513fb66c1c03f27edf4
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\x99\x03\x9fJ\xc8\xfc\xe1\xf8\xce`T(U\x1a\xda\xc5V\xab1\xb6"\x80>\xab\x0c\xe0\xca\xff:\x96\xd0\xe6'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x99\x03\x9fJ\xc8\xfc\xe1\xf8\xce`T(U\x1a\xda\xc5V\xab1\xb6"\x80>\xab\x0c\xe0\xca\xff:\x96\xd0\xe6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02M\xde\xb2\xea"!\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'-\x14\x9d'
MAC: b'\xb0`\x95\xc2\xb3\x0b\x90T\xdd\x02\xdc\x06'nonce b'\x00\x02M\xde\xb2\xea"!'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02M\xde\xb2\xea"!\x00\x00-\x14\x9d\xb0`\x95\xc2\xb3\x0b\x90T\xdd\x02\xdc\x06'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02M\xde\xb2\xea"!\x00\x00-\x14\x9d\xb0`\x95\xc2\xb3\x0b\x90T\xdd\x02\xdc\x06'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02M\xde\xb2\xea"!\x00\x00-\x14\x9d\xb0`\x95\xc2\xb3\x0b\x90T\xdd\x02\xdc\x06'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02f\x9e\x97\xc3\x19\xec\x00\x00c\xbah\xe5~\xaf:8<I\xb1q\xe3\x92\xa54\xafLn\xcd\x87\xb2\xf6\xf5\xe2\x87b\xfa\x96\xfc\xe5J\xf93\xcf[\xe2\x1a\xd6\x8dh\xd3\xf0\xcfG:\x16\xbc6]\x07\xce\x08\x1bJ\xb9\x9b/\xee\x84\xcd\xd8\xf4\xea\x86\xd3;\xaeh\xee~\t[\xa7ol\xf79n\x12.\x84\xe2\x15\xd7L\xda\xcc\xf0\n\\'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02f\x9e\x97\xc3\x19\xec\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x12.\x84\xe2\x15\xd7L\xda\xcc\xf0\n\\'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x99\x03\x9fJ\xc8\xfc\xe1\xf8\xce`T(U\x1a\xda\xc5V\xab1\xb6"\x80>\xab\x0c\xe0\xca\xff:\x96\xd0\xe6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b"\x01\x00\x01\x00\x00\x1f\x00\x03p\x96W\xad\xa4'\x00\x00"
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'[\xb5\x88'
MAC: b'\x94:\x8b\x95\xde\x00\x1c\xe8\xff+\x03\xba'nonce b"\x00\x03p\x96W\xad\xa4'"

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b"\x01\x00\x01\x00\x00\x1f\x00\x03p\x96W\xad\xa4'\x00\x00[\xb5\x88\x94:\x8b\x95\xde\x00\x1c\xe8\xff+\x03\xba"
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b"\x01\x00\x01\x00\x00\x1f\x00\x03p\x96W\xad\xa4'\x00\x00[\xb5\x88\x94:\x8b\x95\xde\x00\x1c\xe8\xff+\x03\xba"
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b"\x01\x00\x01\x00\x00\x1f\x00\x03p\x96W\xad\xa4'\x00\x00[\xb5\x88\x94:\x8b\x95\xde\x00\x1c\xe8\xff+\x03\xba"
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00h\x00\x03f\x9e\x97\xc3\x19\xec\x00\x00\x80\x02\x88l\x0b\xf9\x8cm\x87\xa5\xad\x1e\xb3\xc38\x9cF\x8b[u\x9d\xa4\xad\x07\xaf\xc3\x96=)\xa5\x01f9\x17\xc3V\xc4\xaf+\x92g\xd8\x113\x9d\x1a\xe8\xb4!6X\xd6\xb1\xf08\xde\x02\xf2\xdd\xcbrC\x91\xa0.\x99\xb1\x99\xcd\x07PARy\xc7\xaf\x96\xb5\x0f\x9c\x11\xcbL(\x99s\xd6i'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00h\x00\x03f\x9e\x97\xc3\x19\xec\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x96\xb5\x0f\x9c\x11\xcbL(\x99s\xd6i'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
DEBUG:__main__:command_format
DEBUG:__main__:chd
..
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x99\x03\x9fJ\xc8\xfc\xe1\xf8\xce`T(U\x1a\xda\xc5V\xab1\xb6"\x80>\xab\x0c\xe0\xca\xff:\x96\xd0\xe6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00"'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
..
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00"\x00\x04n>\xec\x8e\xb9\xd2\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'v\xfd\xf6\xcd+('
MAC: b'\xcf\x051L\xf4\xb6\r\xb0Q<\xf0\x14'nonce b'\x00\x04n>\xec\x8e\xb9\xd2'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00"\x00\x04n>\xec\x8e\xb9\xd2\x00\x00v\xfd\xf6\xcd+(\xcf\x051L\xf4\xb6\r\xb0Q<\xf0\x14'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a413b8726688d8ba87c1fc759e1b8b4ac43a76fdc0eb66c8b291275e932f75ec
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b'\x01\x00\x01\x00\x00"\x00\x04n>\xec\x8e\xb9\xd2\x00\x00v\xfd\xf6\xcd+(\xcf\x051L\xf4\xb6\r\xb0Q<\xf0\x14'
Message hash: b"\xa4\x13\xb8rf\x88\xd8\xba\x87\xc1\xfcu\x9e\x1b\x8bJ\xc4:v\xfd\xc0\xebf\xc8\xb2\x91'^\x93/u\xec"

DEBUG:__main__:b'\x01\x00\x01\x00\x00"\x00\x04n>\xec\x8e\xb9\xd2\x00\x00v\xfd\xf6\xcd+(\xcf\x051L\xf4\xb6\r\xb0Q<\xf0\x14'
DEBUG:__main__:b"\xa4\x13\xb8rf\x88\xd8\xba\x87\xc1\xfcu\x9e\x1b\x8bJ\xc4:v\xfd\xc0\xebf\xc8\xb2\x91'^\x93/u\xec"
INFO:__main__:Message sent!
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652133910682487700
alice
aaa
5bf335304cf8d9a7a72722be5bf5b151
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652133910682487700
alice
aaa
5bf335304cf8d9a7a72722be5bf5b151
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01\xee^=\x12p\xd6\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'{\xfa\x0b:\x1a{D\x83\x14i\x91\xe9'nonce b'\x00\x01\xee^=\x12p\xd6'
tk: b'v\x07\xab[\xabV\xea\x9bg4\xbe\x96\x96V\x92\xe1\xe7\xaf\xfc\x83 \xd3\xa3\xd6\xdcB\x10\xf41^\xd4v'
encrypted payload: b'k2C=\xf5^\xc2\x8b\x1c\x18FO\xaa\x1d\xba\x7f2\x10\xf4\xba\xbe\xadD\xef\xe7\xf9pn\xfe\xf5#Uc\x11\x06\xba\xe9\x06\xd8\x87v\xd6\xb1\x17\xd4uv\xd8\xc2\r\x82\x86\x1b\x1e\xe2\xa1s\x85C~\xaf\xdd'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'RF}\xa93Z\xf7\x99\n\xadGx:\xf6\xda\xfc\xd6Ut4zD\n\x028\x04\xc2\xd0\xad\x06\xd1\xf7\xf2\xee\xe9\x0fw\x97\xf9x\xb0\xbf*?\x95X\x89s[b\xc37\xa9\xea9\xc2\xa0\x9b\xe1\x8d\x0f\x9e\x9a\xca \xdf*+b\xa9F\xc7\xfcP\r\xbb~\x7f\x91\xe2a\xf8\xa5\xf6PBWm\xb7\x08\r\xeb\xafUu\xe6\x05\xd2\xc7\x8e\x85\xcfa\xd1L\xef\x01\\E\xb3S/9\xf2\x99I\xe2M\xf0\x04\x8c\xbeH\x94\xe6?\x1e\xf0\xd5\r&(\x02s\x89\x1aH\x82\x1a\x93\xf6\x06\xc5\x94\xdf\xde\x10\xb3\xca\xb6%w\xab\x85\x1d8\xe0\x17\xaa\x99\xb5\xa3V\x0ea\xe5\x9a\xbdt\xcdG0\x84\x9aa\x02*\x9a0:}\x90%\x04\xe7\xa5s\xb3{\xb8\x06e8\x0eW\x08.\x80\xafy\x0c@rVC\xf8&\xc5i8 \x92\xf7\x12\xd4O)\xddaB\x8ff\x17\xc7\xa9\xb6W\xc7<v,\xdf\xa7@2\xf3\njD\x15\xc2\xeb*\x08\x05\xa6\x8bk\x80RJ\xfbdd\xa7\x80'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01\xee^=\x12p\xd6\x00\x00k2C=\xf5^\xc2\x8b\x1c\x18FO\xaa\x1d\xba\x7f2\x10\xf4\xba\xbe\xadD\xef\xe7\xf9pn\xfe\xf5#Uc\x11\x06\xba\xe9\x06\xd8\x87v\xd6\xb1\x17\xd4uv\xd8\xc2\r\x82\x86\x1b\x1e\xe2\xa1s\x85C~\xaf\xdd{\xfa\x0b:\x1a{D\x83\x14i\x91\xe9RF}\xa93Z\xf7\x99\n\xadGx:\xf6\xda\xfc\xd6Ut4zD\n\x028\x04\xc2\xd0\xad\x06\xd1\xf7\xf2\xee\xe9\x0fw\x97\xf9x\xb0\xbf*?\x95X\x89s[b\xc37\xa9\xea9\xc2\xa0\x9b\xe1\x8d\x0f\x9e\x9a\xca \xdf*+b\xa9F\xc7\xfcP\r\xbb~\x7f\x91\xe2a\xf8\xa5\xf6PBWm\xb7\x08\r\xeb\xafUu\xe6\x05\xd2\xc7\x8e\x85\xcfa\xd1L\xef\x01\\E\xb3S/9\xf2\x99I\xe2M\xf0\x04\x8c\xbeH\x94\xe6?\x1e\xf0\xd5\r&(\x02s\x89\x1aH\x82\x1a\x93\xf6\x06\xc5\x94\xdf\xde\x10\xb3\xca\xb6%w\xab\x85\x1d8\xe0\x17\xaa\x99\xb5\xa3V\x0ea\xe5\x9a\xbdt\xcdG0\x84\x9aa\x02*\x9a0:}\x90%\x04\xe7\xa5s\xb3{\xb8\x06e8\x0eW\x08.\x80\xafy\x0c@rVC\xf8&\xc5i8 \x92\xf7\x12\xd4O)\xddaB\x8ff\x17\xc7\xa9\xb6W\xc7<v,\xdf\xa7@2\xf3\njD\x15\xc2\xeb*\x08\x05\xa6\x8bk\x80RJ\xfbdd\xa7\x80'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01\xee^=\x12p\xd6\x00\x00k2C=\xf5^\xc2\x8b\x1c\x18FO\xaa\x1d\xba\x7f2\x10\xf4\xba\xbe\xadD\xef\xe7\xf9pn\xfe\xf5#Uc\x11\x06\xba\xe9\x06\xd8\x87v\xd6\xb1\x17\xd4uv\xd8\xc2\r\x82\x86\x1b\x1e\xe2\xa1s\x85C~\xaf\xdd{\xfa\x0b:\x1a{D\x83\x14i\x91\xe9RF}\xa93Z\xf7\x99\n\xadGx:\xf6\xda\xfc\xd6Ut4zD\n\x028\x04\xc2\xd0\xad\x06\xd1\xf7\xf2\xee\xe9\x0fw\x97\xf9x\xb0\xbf*?\x95X\x89s[b\xc37\xa9\xea9\xc2\xa0\x9b\xe1\x8d\x0f\x9e\x9a\xca \xdf*+b\xa9F\xc7\xfcP\r\xbb~\x7f\x91\xe2a\xf8\xa5\xf6PBWm\xb7\x08\r\xeb\xafUu\xe6\x05\xd2\xc7\x8e\x85\xcfa\xd1L\xef\x01\\E\xb3S/9\xf2\x99I\xe2M\xf0\x04\x8c\xbeH\x94\xe6?\x1e\xf0\xd5\r&(\x02s\x89\x1aH\x82\x1a\x93\xf6\x06\xc5\x94\xdf\xde\x10\xb3\xca\xb6%w\xab\x85\x1d8\xe0\x17\xaa\x99\xb5\xa3V\x0ea\xe5\x9a\xbdt\xcdG0\x84\x9aa\x02*\x9a0:}\x90%\x04\xe7\xa5s\xb3{\xb8\x06e8\x0eW\x08.\x80\xafy\x0c@rVC\xf8&\xc5i8 \x92\xf7\x12\xd4O)\xddaB\x8ff\x17\xc7\xa9\xb6W\xc7<v,\xdf\xa7@2\xf3\njD\x15\xc2\xeb*\x08\x05\xa6\x8bk\x80RJ\xfbdd\xa7\x80'
DEBUG:SiFT_MTP:TK from MTP: b'v\x07\xab[\xabV\xea\x9bg4\xbe\x96\x96V\x92\xe1\xe7\xaf\xfc\x83 \xd3\xa3\xd6\xdcB\x10\xf41^\xd4v'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: d5f5cd4e022158b2d1600a37e2fbee0a9553d4fbd5cac152989e4d1c45d73ee0
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01\xee^=\x12p\xd6\x00\x00k2C=\xf5^\xc2\x8b\x1c\x18FO\xaa\x1d\xba\x7f2\x10\xf4\xba\xbe\xadD\xef\xe7\xf9pn\xfe\xf5#Uc\x11\x06\xba\xe9\x06\xd8\x87v\xd6\xb1\x17\xd4uv\xd8\xc2\r\x82\x86\x1b\x1e\xe2\xa1s\x85C~\xaf\xdd{\xfa\x0b:\x1a{D\x83\x14i\x91\xe9RF}\xa93Z\xf7\x99\n\xadGx:\xf6\xda\xfc\xd6Ut4zD\n\x028\x04\xc2\xd0\xad\x06\xd1\xf7\xf2\xee\xe9\x0fw\x97\xf9x\xb0\xbf*?\x95X\x89s[b\xc37\xa9\xea9\xc2\xa0\x9b\xe1\x8d\x0f\x9e\x9a\xca \xdf*+b\xa9F\xc7\xfcP\r\xbb~\x7f\x91\xe2a\xf8\xa5\xf6PBWm\xb7\x08\r\xeb\xafUu\xe6\x05\xd2\xc7\x8e\x85\xcfa\xd1L\xef\x01\\E\xb3S/9\xf2\x99I\xe2M\xf0\x04\x8c\xbeH\x94\xe6?\x1e\xf0\xd5\r&(\x02s\x89\x1aH\x82\x1a\x93\xf6\x06\xc5\x94\xdf\xde\x10\xb3\xca\xb6%w\xab\x85\x1d8\xe0\x17\xaa\x99\xb5\xa3V\x0ea\xe5\x9a\xbdt\xcdG0\x84\x9aa\x02*\x9a0:}\x90%\x04\xe7\xa5s\xb3{\xb8\x06e8\x0eW\x08.\x80\xafy\x0c@rVC\xf8&\xc5i8 \x92\xf7\x12\xd4O)\xddaB\x8ff\x17\xc7\xa9\xb6W\xc7<v,\xdf\xa7@2\xf3\njD\x15\xc2\xeb*\x08\x05\xa6\x8bk\x80RJ\xfbdd\xa7\x80'
Message hash: b'\xd5\xf5\xcdN\x02!X\xb2\xd1`\n7\xe2\xfb\xee\n\x95S\xd4\xfb\xd5\xca\xc1R\x98\x9eM\x1cE\xd7>\xe0'
My random: 5bf335304cf8d9a7a72722be5bf5b151
Temp key: b'v\x07\xab[\xabV\xea\x9bg4\xbe\x96\x96V\x92\xe1\xe7\xaf\xfc\x83 \xd3\xa3\xd6\xdcB\x10\xf41^\xd4v'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00\x81\xd1\x10:\xea\xe6\x0f\xe4W^\x89\x85\xe2\xc9^i\x83\xf7\x0c\x7f\x06\x17,\x02\xbd08\x1a;\x81\xc0k\xfe\xce\x8b\xad\xa3\xe7Jl\xa0\xf44\xc4l.o\x1e0\xad\x156g\xf7\xa0F\x9cC\x1aWZi\xfc\x111\xfa\x86x\xa2\x80H\xa5T\x04\xdb\xf8\xa8\xe5\xd5X\x90\xf6\x16Q\xc6|\xea];\x94|\xd3\xe5F\x86\x16\xe6E\xba\xb9\xac\x160\x13\xf0\xa1!\xa1\xd4'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00\x81\xd1\x10:\xea\xe6\x0f\xe4W^\x89\x85\xe2\xc9^i\x83\xf7\x0c\x7f\x06\x17,\x02\xbd08\x1a;\x81\xc0k\xfe\xce\x8b\xad\xa3\xe7Jl\xa0\xf44\xc4l.o\x1e0\xad\x156g\xf7\xa0F\x9cC\x1aWZi\xfc\x111\xfa\x86x\xa2\x80H\xa5T\x04\xdb\xf8\xa8\xe5\xd5X\x90\xf6\x16Q\xc6|\xea];\x94|\xd3\xe5F\x86\x16\xe6E\xba\xb9\xac\x160\x13\xf0\xa1!\xa1\xd4'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xe7\xe0\xb3a\x05\x9b\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'E\xba\xb9\xac\x160\x13\xf0\xa1!\xa1\xd4'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'd5f5cd4e022158b2d1600a37e2fbee0a9553d4fbd5cac152989e4d1c45d73ee0\ne35b93b5aeffa6ca5a3c5be2385f22cb'
DEBUG:SiFT_MTP:d5f5cd4e022158b2d1600a37e2fbee0a9553d4fbd5cac152989e4d1c45d73ee0
e35b93b5aeffa6ca5a3c5be2385f22cb
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xce\xb9B\xa3H\xee,\xf5Q\xbd\xdb@u\xf0\x1dD\x1b\x87\x95\xc1|\xcc\xca5h\xde\xe9v.\x8d\xea]'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['mkd', 'test']
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xce\xb9B\xa3H\xee,\xf5Q\xbd\xdb@u\xf0\x1dD\x1b\x87\x95\xc1|\xcc\xca5h\xde\xe9v.\x8d\xea]'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00$'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00$\x00\x02@\x0cWk\x87\x05\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xc13\x7f\x08\x15\xb2\xf6\x11'
MAC: b'\xa8\xd2VUj \x98\x7f\x01\x0e\xb9\xc6'nonce b'\x00\x02@\x0cWk\x87\x05'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00$\x00\x02@\x0cWk\x87\x05\x00\x00\xc13\x7f\x08\x15\xb2\xf6\x11\xa8\xd2VUj \x98\x7f\x01\x0e\xb9\xc6'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00$\x00\x02@\x0cWk\x87\x05\x00\x00\xc13\x7f\x08\x15\xb2\xf6\x11\xa8\xd2VUj \x98\x7f\x01\x0e\xb9\xc6'
Message hash: b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'

DEBUG:__main__:b'\x01\x00\x01\x00\x00$\x00\x02@\x0cWk\x87\x05\x00\x00\xc13\x7f\x08\x15\xb2\xf6\x11\xa8\xd2VUj \x98\x7f\x01\x0e\xb9\xc6'
DEBUG:__main__:b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'
INFO:__main__:Message sent!
ERROR:__main__:An error was occurred during the process: [WinError 10054] An existing connection was forcibly closed by the remote host
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134199662255900
alice
aaa
b836ffb5654c08300e3f0983b161d036
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134199662255900
alice
aaa
b836ffb5654c08300e3f0983b161d036
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01&\x06\x89\x89\x02p\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x1d\xb4\xe8H\x82\xfdw\xe4<\xb9\xea\xaa'nonce b'\x00\x01&\x06\x89\x89\x02p'
tk: b'f`\x87!9\xe4N/\xf2u6\xfd\x15\x90m!\xafB\xf3\xd1\xcd\xa5P\xf9\xd2S\xbb\xfaz\xf6\xe1\xed'
encrypted payload: b'\xa5\x00\x9c&\x8da&\xa5\xf0:\x1fX.r\xc2\xd2=[f\x91{\xfb\xf2\xdf}\x7f\xa1\xa5\x16\xc6\x9d\xe5\xb7\xd7L\\\x0bCx\x01g\x08:]&\xe4$\xeax\x17\x1b\xa5# \xdb\xa6x\x1f\xaaT(\xab'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'Kr\x94\xbe\x8c\xffX\xe5\x9d\x87\xb0b\xdd\xb6\xd5f\xb0e\xe3\xc2\xc4&/\xb0\x18\xc5\xcd]\xe1\x9fo\xf7\xc2\xe7vN0\xcd\'Q\xb1\x9b\xfa\x85<\xed\xb8\xec\xfdW\xe1\x82n]\xb6jw\xd9\xe1R?\xd3\xb5\x90\xb4\x1ac\xc5\xa92P\xf48\x90)\xec\x99\x80\n\xb6{-\xb0\xb4\x1d\xcfu\x85T\x0e\x80\xda\xbct\x89n\xe8\xe6\xccf\xcb\xccF#\xd0\xe5\xf6\xae\x12\x87\x98\x04K\xd9\xc8\x8au\xf7\x83\xb3\xff(\'\xea\xf2\x89~18\xdf\xd1\x03\xf3b\xaa!\x02\xceuJ:\x1a\xfeXH9\xf2\xcd\xa5\x94\x12\x7f\x16\x04\x1a\xb6\xc2^4\x18\x9d/\x9c\xc8 s[\xc6\xb0\xda\x13\x90\xdbF\x84\x15FU;\xe1J\x94Ve\xb0\xf9\xb9\x16\x9aS\xbb\xfa\x0br\x9a\x9bv\t67O\x84\x1f.\x91K\xd3\xfc\xf3\xe1P\xd9++\xben\xd8\xe8\x9e4~\xbb"\xdc\xd6~\x8a\xb1\xf7\xbfu\x87M\xfc\x1c<\x96\xebv8b\xb3]J\x90\x1276$=\x85\x1aW\xb7gK'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01&\x06\x89\x89\x02p\x00\x00\xa5\x00\x9c&\x8da&\xa5\xf0:\x1fX.r\xc2\xd2=[f\x91{\xfb\xf2\xdf}\x7f\xa1\xa5\x16\xc6\x9d\xe5\xb7\xd7L\\\x0bCx\x01g\x08:]&\xe4$\xeax\x17\x1b\xa5# \xdb\xa6x\x1f\xaaT(\xab\x1d\xb4\xe8H\x82\xfdw\xe4<\xb9\xea\xaaKr\x94\xbe\x8c\xffX\xe5\x9d\x87\xb0b\xdd\xb6\xd5f\xb0e\xe3\xc2\xc4&/\xb0\x18\xc5\xcd]\xe1\x9fo\xf7\xc2\xe7vN0\xcd\'Q\xb1\x9b\xfa\x85<\xed\xb8\xec\xfdW\xe1\x82n]\xb6jw\xd9\xe1R?\xd3\xb5\x90\xb4\x1ac\xc5\xa92P\xf48\x90)\xec\x99\x80\n\xb6{-\xb0\xb4\x1d\xcfu\x85T\x0e\x80\xda\xbct\x89n\xe8\xe6\xccf\xcb\xccF#\xd0\xe5\xf6\xae\x12\x87\x98\x04K\xd9\xc8\x8au\xf7\x83\xb3\xff(\'\xea\xf2\x89~18\xdf\xd1\x03\xf3b\xaa!\x02\xceuJ:\x1a\xfeXH9\xf2\xcd\xa5\x94\x12\x7f\x16\x04\x1a\xb6\xc2^4\x18\x9d/\x9c\xc8 s[\xc6\xb0\xda\x13\x90\xdbF\x84\x15FU;\xe1J\x94Ve\xb0\xf9\xb9\x16\x9aS\xbb\xfa\x0br\x9a\x9bv\t67O\x84\x1f.\x91K\xd3\xfc\xf3\xe1P\xd9++\xben\xd8\xe8\x9e4~\xbb"\xdc\xd6~\x8a\xb1\xf7\xbfu\x87M\xfc\x1c<\x96\xebv8b\xb3]J\x90\x1276$=\x85\x1aW\xb7gK'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01&\x06\x89\x89\x02p\x00\x00\xa5\x00\x9c&\x8da&\xa5\xf0:\x1fX.r\xc2\xd2=[f\x91{\xfb\xf2\xdf}\x7f\xa1\xa5\x16\xc6\x9d\xe5\xb7\xd7L\\\x0bCx\x01g\x08:]&\xe4$\xeax\x17\x1b\xa5# \xdb\xa6x\x1f\xaaT(\xab\x1d\xb4\xe8H\x82\xfdw\xe4<\xb9\xea\xaaKr\x94\xbe\x8c\xffX\xe5\x9d\x87\xb0b\xdd\xb6\xd5f\xb0e\xe3\xc2\xc4&/\xb0\x18\xc5\xcd]\xe1\x9fo\xf7\xc2\xe7vN0\xcd\'Q\xb1\x9b\xfa\x85<\xed\xb8\xec\xfdW\xe1\x82n]\xb6jw\xd9\xe1R?\xd3\xb5\x90\xb4\x1ac\xc5\xa92P\xf48\x90)\xec\x99\x80\n\xb6{-\xb0\xb4\x1d\xcfu\x85T\x0e\x80\xda\xbct\x89n\xe8\xe6\xccf\xcb\xccF#\xd0\xe5\xf6\xae\x12\x87\x98\x04K\xd9\xc8\x8au\xf7\x83\xb3\xff(\'\xea\xf2\x89~18\xdf\xd1\x03\xf3b\xaa!\x02\xceuJ:\x1a\xfeXH9\xf2\xcd\xa5\x94\x12\x7f\x16\x04\x1a\xb6\xc2^4\x18\x9d/\x9c\xc8 s[\xc6\xb0\xda\x13\x90\xdbF\x84\x15FU;\xe1J\x94Ve\xb0\xf9\xb9\x16\x9aS\xbb\xfa\x0br\x9a\x9bv\t67O\x84\x1f.\x91K\xd3\xfc\xf3\xe1P\xd9++\xben\xd8\xe8\x9e4~\xbb"\xdc\xd6~\x8a\xb1\xf7\xbfu\x87M\xfc\x1c<\x96\xebv8b\xb3]J\x90\x1276$=\x85\x1aW\xb7gK'
DEBUG:SiFT_MTP:TK from MTP: b'f`\x87!9\xe4N/\xf2u6\xfd\x15\x90m!\xafB\xf3\xd1\xcd\xa5P\xf9\xd2S\xbb\xfaz\xf6\xe1\xed'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 79517b12089b84b334f2700b27c5969022294e1695baea2eff2819fa35289de1
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01&\x06\x89\x89\x02p\x00\x00\xa5\x00\x9c&\x8da&\xa5\xf0:\x1fX.r\xc2\xd2=[f\x91{\xfb\xf2\xdf}\x7f\xa1\xa5\x16\xc6\x9d\xe5\xb7\xd7L\\\x0bCx\x01g\x08:]&\xe4$\xeax\x17\x1b\xa5# \xdb\xa6x\x1f\xaaT(\xab\x1d\xb4\xe8H\x82\xfdw\xe4<\xb9\xea\xaaKr\x94\xbe\x8c\xffX\xe5\x9d\x87\xb0b\xdd\xb6\xd5f\xb0e\xe3\xc2\xc4&/\xb0\x18\xc5\xcd]\xe1\x9fo\xf7\xc2\xe7vN0\xcd\'Q\xb1\x9b\xfa\x85<\xed\xb8\xec\xfdW\xe1\x82n]\xb6jw\xd9\xe1R?\xd3\xb5\x90\xb4\x1ac\xc5\xa92P\xf48\x90)\xec\x99\x80\n\xb6{-\xb0\xb4\x1d\xcfu\x85T\x0e\x80\xda\xbct\x89n\xe8\xe6\xccf\xcb\xccF#\xd0\xe5\xf6\xae\x12\x87\x98\x04K\xd9\xc8\x8au\xf7\x83\xb3\xff(\'\xea\xf2\x89~18\xdf\xd1\x03\xf3b\xaa!\x02\xceuJ:\x1a\xfeXH9\xf2\xcd\xa5\x94\x12\x7f\x16\x04\x1a\xb6\xc2^4\x18\x9d/\x9c\xc8 s[\xc6\xb0\xda\x13\x90\xdbF\x84\x15FU;\xe1J\x94Ve\xb0\xf9\xb9\x16\x9aS\xbb\xfa\x0br\x9a\x9bv\t67O\x84\x1f.\x91K\xd3\xfc\xf3\xe1P\xd9++\xben\xd8\xe8\x9e4~\xbb"\xdc\xd6~\x8a\xb1\xf7\xbfu\x87M\xfc\x1c<\x96\xebv8b\xb3]J\x90\x1276$=\x85\x1aW\xb7gK'
Message hash: b'yQ{\x12\x08\x9b\x84\xb34\xf2p\x0b\'\xc5\x96\x90")N\x16\x95\xba\xea.\xff(\x19\xfa5(\x9d\xe1'
My random: b836ffb5654c08300e3f0983b161d036
Temp key: b'f`\x87!9\xe4N/\xf2u6\xfd\x15\x90m!\xafB\xf3\xd1\xcd\xa5P\xf9\xd2S\xbb\xfaz\xf6\xe1\xed'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01\xc3\x8e\xf0\xc0J`\x00\x00A<\xf1\xbc\xa2>\x94\xc7\x82\xf3\x13EN\xfdp\xa2\xff\xb3\xdd\xba\xec+\xcb\x04\x1d\x98\xff\x14u\x9f\x8a\xd45\x93T\xee\xbbA\xaa\xd6\xda\xb8\xad\x85\xf5\xa6\xdfn\xffvVu\x91<A\x97\x93\xe6\xc0\x16"GUJB\nG&\x805\xb6\xafw\xd8\x841\xf4ds\xc1\xc6(*}\xb9\nXaF{\xfe\x8b\x02i\xabU\x1c\xa9\x18\xbc\xeb\xdd\x074\xe9\xfdR\r\x0c'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01\xc3\x8e\xf0\xc0J`\x00\x00A<\xf1\xbc\xa2>\x94\xc7\x82\xf3\x13EN\xfdp\xa2\xff\xb3\xdd\xba\xec+\xcb\x04\x1d\x98\xff\x14u\x9f\x8a\xd45\x93T\xee\xbbA\xaa\xd6\xda\xb8\xad\x85\xf5\xa6\xdfn\xffvVu\x91<A\x97\x93\xe6\xc0\x16"GUJB\nG&\x805\xb6\xafw\xd8\x841\xf4ds\xc1\xc6(*}\xb9\nXaF{\xfe\x8b\x02i\xabU\x1c\xa9\x18\xbc\xeb\xdd\x074\xe9\xfdR\r\x0c'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xc3\x8e\xf0\xc0J`\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xa9\x18\xbc\xeb\xdd\x074\xe9\xfdR\r\x0c'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'79517b12089b84b334f2700b27c5969022294e1695baea2eff2819fa35289de1\n387328fa2ceafb39a7ed3f652eb1ccf3'
DEBUG:SiFT_MTP:79517b12089b84b334f2700b27c5969022294e1695baea2eff2819fa35289de1
387328fa2ceafb39a7ed3f652eb1ccf3
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xdd\x94\x00\xa5\xce\x8e\xd39\xbc\xa2\x94\xd5H_\x1c\x83\xc7\xbc\xa85eZF\x0c\x90\xdc{2X\x1d\xc9\x96'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xdd\x94\x00\xa5\xce\x8e\xd39\xbc\xa2\x94\xd5H_\x1c\x83\xc7\xbc\xa85eZF\x0c\x90\xdc{2X\x1d\xc9\x96'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xa4\xa4&)\xfe)\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xa8a\xa9'
MAC: b'\xcey\x97\xc4k2&\xa6%\xfc\xdd\x82'nonce b'\x00\x02\xa4\xa4&)\xfe)'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02\xa4\xa4&)\xfe)\x00\x00\xa8a\xa9\xcey\x97\xc4k2&\xa6%\xfc\xdd\x82'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02\xa4\xa4&)\xfe)\x00\x00\xa8a\xa9\xcey\x97\xc4k2&\xa6%\xfc\xdd\x82'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xa4\xa4&)\xfe)\x00\x00\xa8a\xa9\xcey\x97\xc4k2&\xa6%\xfc\xdd\x82'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02\xee\x16\x18\x10e>\x00\x00\xe2\xcc\xb9f\t(8\xfe\x93E\t\x0e_@\xdb\x8e\x89\xe6\xd2\x7f\xef\x85\xaaE\x81#1dsf|\xedY+-\x14\xef\x0f}\xe3e\xf1\x06\x98\x947\xa3\xee\x81\xbb;\xd0\xe7\x96$0z\xc2@\x87\xc8;^D\xfa\x82\x02\xfc\xbb)\xd6\xd1\x1f0\xf7\x89-\xf17\xb9\x8e\xb3\xc2z\xc1\x84$\xa6\x8aY\xf4'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02\xee\x16\x18\x10e>\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xb9\x8e\xb3\xc2z\xc1\x84$\xa6\x8aY\xf4'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xdd\x94\x00\xa5\xce\x8e\xd39\xbc\xa2\x94\xd5H_\x1c\x83\xc7\xbc\xa85eZF\x0c\x90\xdc{2X\x1d\xc9\x96'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x03P\x08\x08\xecw\xd8\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xf0\t\x0f'
MAC: b'\xd7\xbb\xd7\xc3Y\x07b}\xa7\xcaE\xa7'nonce b'\x00\x03P\x08\x08\xecw\xd8'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x03P\x08\x08\xecw\xd8\x00\x00\xf0\t\x0f\xd7\xbb\xd7\xc3Y\x07b}\xa7\xcaE\xa7'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x03P\x08\x08\xecw\xd8\x00\x00\xf0\t\x0f\xd7\xbb\xd7\xc3Y\x07b}\xa7\xcaE\xa7'
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x03P\x08\x08\xecw\xd8\x00\x00\xf0\t\x0f\xd7\xbb\xd7\xc3Y\x07b}\xa7\xcaE\xa7'
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00n\x00\x03\xee\x16\x18\x10e>\x00\x00u\x95\xcb\x9c\x890{\xfe\xbc"\xcf\x11\xb70\x8f\xc7\x1a\xfaY{\xa0\xe8T\xab\x85R\x80\x8c\t\x1enU_\xae\x86\x96\t\xf0\x1b5\xc2\xf3\x96]\x99\xa9<\xf5\xd5 \x06\xf4%\x84\xb9A5b\xe3\xbdyH\xcb\xbaV\xd9\xc6\xec\xe1\x14\x00\x12h\x0bM.\xff\x80\xfd\xaf)\xc8_\x0br\x1a}\x11\xcf\xbf\x1dR\xcb\xe3'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00n\x00\x03\xee\x16\x18\x10e>\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'_\x0br\x1a}\x11\xcf\xbf\x1dR\xcb\xe3'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess\ntest1'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
test1
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test3
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xdd\x94\x00\xa5\xce\x8e\xd39\xbc\xa2\x94\xd5H_\x1c\x83\xc7\xbc\xa85eZF\x0c\x90\xdc{2X\x1d\xc9\x96'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test3
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x04l\x9a6\x0ek\xf3\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xb1%\xdc\xa4\x880G\xb67'
MAC: b'\x13/\xb9\xb8:y\xe0\xa8\xa2\x8c\xe1\xcb'nonce b'\x00\x04l\x9a6\x0ek\xf3'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00%\x00\x04l\x9a6\x0ek\xf3\x00\x00\xb1%\xdc\xa4\x880G\xb67\x13/\xb9\xb8:y\xe0\xa8\xa2\x8c\xe1\xcb'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 858adca5afefb4caa884f5432c3bd9bd02c4ea0c5cc6c98f8a797896b80dbec6
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b'\x01\x00\x01\x00\x00%\x00\x04l\x9a6\x0ek\xf3\x00\x00\xb1%\xdc\xa4\x880G\xb67\x13/\xb9\xb8:y\xe0\xa8\xa2\x8c\xe1\xcb'
Message hash: b'\x85\x8a\xdc\xa5\xaf\xef\xb4\xca\xa8\x84\xf5C,;\xd9\xbd\x02\xc4\xea\x0c\\\xc6\xc9\x8f\x8ayx\x96\xb8\r\xbe\xc6'

DEBUG:__main__:b'\x01\x00\x01\x00\x00%\x00\x04l\x9a6\x0ek\xf3\x00\x00\xb1%\xdc\xa4\x880G\xb67\x13/\xb9\xb8:y\xe0\xa8\xa2\x8c\xe1\xcb'
DEBUG:__main__:b'\x85\x8a\xdc\xa5\xaf\xef\xb4\xca\xa8\x84\xf5C,;\xd9\xbd\x02\xc4\xea\x0c\\\xc6\xc9\x8f\x8ayx\x96\xb8\r\xbe\xc6'
INFO:__main__:Message sent!
ERROR:__main__:An error was occurred during the process: [WinError 10054] An existing connection was forcibly closed by the remote host
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134326618267500
alice
aaa
9f3db8fcb7beab66acdd3cd70fc47700
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134326618267500
alice
aaa
9f3db8fcb7beab66acdd3cd70fc47700
DEBUG:SiFT_MTP:b"\x01\x00\x00\x00\x01Z\x00\x01m\x1b#\xab'\xe1\x00\x00"
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x12q\x98\xf3\xbe)\x93\xba`\xcdW\xf2'nonce b"\x00\x01m\x1b#\xab'\xe1"
tk: b'\x11NE\x94\xf4;B\x1a\xbdf\xe6e\xc46\x11\x93r\xd5=W\x1aa\x88\xe7\xed\x94\x911\xebE\x91o'
encrypted payload: b'\x0f\xaf\x03]Jp\xded\x9f\xf6:Q\xa9L\xc9\x9f\xf7mV\xc4_\xfd\x9a*|\xb0\xeaJ?u\x0f\xac\xfb\xce\xb4t\xd7/\x15\x13\x91r\xd95N\xf8\x8a\xf6P\xaa4 O\xd2\xb3\xa6\x16\x9d\xea\x99\xa3+'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b"\x8b}\x1c_\x8ct\xef\x88\x00mA\xb8hB\xb5\xfb\xda\x98\xed\x8e\xaa.\x0c\x83\xe7)\xa4\xe0\x8b\xd5\xd6\xd7\xac\xa7\xaa\xf7'\xd0e\xd4O\x956\xcc\xff\x80\x1en\xcfZU\x9a;\xee\x8c\x10i\x0fO\x97\xcdAX\x96I\xad\xfc\x10\x18~\xd4p\xb4\x1e\x9a\xcc\xb4|\xa1\xe8*\x13b\xdb\xd9\xdcw\x83\x9f\x15\x06\xeb\xa1\x08\xa2m\xbfa\xfa\x95\xb4\xb0\xa6\x91m#\x06cMJ?\xb6Xn\x1ee.\xa9\xc0S#9q\x9e\x13o\xde\x1d\xd3\x0cb\x15\x92\x1f\x1ep\x95M\x03\xf5d\x19\xfa\x9f+\xf0\xbc!\xca\xb2\xdf,\xca\x1d\xe2v\x0c\x97\xe7v\x85_\xac]fn\xb4*\xd6`U\xf7\xd3\xf2g\xf7pQ\xdd5o\xcd\xc9q\t\xd7\xe1\r\xc4\x99JS'K#\x0e\x1e\x1f\x08\xe6j\xd7\x0fmR%\xd4Hb\xa9\x93\x0b\xb1\xea\x05\x8c\xf5r\x1e\xca\x83|D\xa8\x97\xc7\xa2\xb2\xa2\x97o/@\xe5\xbez7,w\xc0\xfdDR\xda\xa6MIM\x87\xb1\xc3\xf8\x85E\x9c\x9c"
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b"\x01\x00\x00\x00\x01Z\x00\x01m\x1b#\xab'\xe1\x00\x00\x0f\xaf\x03]Jp\xded\x9f\xf6:Q\xa9L\xc9\x9f\xf7mV\xc4_\xfd\x9a*|\xb0\xeaJ?u\x0f\xac\xfb\xce\xb4t\xd7/\x15\x13\x91r\xd95N\xf8\x8a\xf6P\xaa4 O\xd2\xb3\xa6\x16\x9d\xea\x99\xa3+\x12q\x98\xf3\xbe)\x93\xba`\xcdW\xf2\x8b}\x1c_\x8ct\xef\x88\x00mA\xb8hB\xb5\xfb\xda\x98\xed\x8e\xaa.\x0c\x83\xe7)\xa4\xe0\x8b\xd5\xd6\xd7\xac\xa7\xaa\xf7'\xd0e\xd4O\x956\xcc\xff\x80\x1en\xcfZU\x9a;\xee\x8c\x10i\x0fO\x97\xcdAX\x96I\xad\xfc\x10\x18~\xd4p\xb4\x1e\x9a\xcc\xb4|\xa1\xe8*\x13b\xdb\xd9\xdcw\x83\x9f\x15\x06\xeb\xa1\x08\xa2m\xbfa\xfa\x95\xb4\xb0\xa6\x91m#\x06cMJ?\xb6Xn\x1ee.\xa9\xc0S#9q\x9e\x13o\xde\x1d\xd3\x0cb\x15\x92\x1f\x1ep\x95M\x03\xf5d\x19\xfa\x9f+\xf0\xbc!\xca\xb2\xdf,\xca\x1d\xe2v\x0c\x97\xe7v\x85_\xac]fn\xb4*\xd6`U\xf7\xd3\xf2g\xf7pQ\xdd5o\xcd\xc9q\t\xd7\xe1\r\xc4\x99JS'K#\x0e\x1e\x1f\x08\xe6j\xd7\x0fmR%\xd4Hb\xa9\x93\x0b\xb1\xea\x05\x8c\xf5r\x1e\xca\x83|D\xa8\x97\xc7\xa2\xb2\xa2\x97o/@\xe5\xbez7,w\xc0\xfdDR\xda\xa6MIM\x87\xb1\xc3\xf8\x85E\x9c\x9c"
DEBUG:SiFT_MTP:Message from MTP: b"\x01\x00\x00\x00\x01Z\x00\x01m\x1b#\xab'\xe1\x00\x00\x0f\xaf\x03]Jp\xded\x9f\xf6:Q\xa9L\xc9\x9f\xf7mV\xc4_\xfd\x9a*|\xb0\xeaJ?u\x0f\xac\xfb\xce\xb4t\xd7/\x15\x13\x91r\xd95N\xf8\x8a\xf6P\xaa4 O\xd2\xb3\xa6\x16\x9d\xea\x99\xa3+\x12q\x98\xf3\xbe)\x93\xba`\xcdW\xf2\x8b}\x1c_\x8ct\xef\x88\x00mA\xb8hB\xb5\xfb\xda\x98\xed\x8e\xaa.\x0c\x83\xe7)\xa4\xe0\x8b\xd5\xd6\xd7\xac\xa7\xaa\xf7'\xd0e\xd4O\x956\xcc\xff\x80\x1en\xcfZU\x9a;\xee\x8c\x10i\x0fO\x97\xcdAX\x96I\xad\xfc\x10\x18~\xd4p\xb4\x1e\x9a\xcc\xb4|\xa1\xe8*\x13b\xdb\xd9\xdcw\x83\x9f\x15\x06\xeb\xa1\x08\xa2m\xbfa\xfa\x95\xb4\xb0\xa6\x91m#\x06cMJ?\xb6Xn\x1ee.\xa9\xc0S#9q\x9e\x13o\xde\x1d\xd3\x0cb\x15\x92\x1f\x1ep\x95M\x03\xf5d\x19\xfa\x9f+\xf0\xbc!\xca\xb2\xdf,\xca\x1d\xe2v\x0c\x97\xe7v\x85_\xac]fn\xb4*\xd6`U\xf7\xd3\xf2g\xf7pQ\xdd5o\xcd\xc9q\t\xd7\xe1\r\xc4\x99JS'K#\x0e\x1e\x1f\x08\xe6j\xd7\x0fmR%\xd4Hb\xa9\x93\x0b\xb1\xea\x05\x8c\xf5r\x1e\xca\x83|D\xa8\x97\xc7\xa2\xb2\xa2\x97o/@\xe5\xbez7,w\xc0\xfdDR\xda\xa6MIM\x87\xb1\xc3\xf8\x85E\x9c\x9c"
DEBUG:SiFT_MTP:TK from MTP: b'\x11NE\x94\xf4;B\x1a\xbdf\xe6e\xc46\x11\x93r\xd5=W\x1aa\x88\xe7\xed\x94\x911\xebE\x91o'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 42ebec6423ddd956de56364562375c42dcd1e8095cb8ad02d0967bb0a2df6bad
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b"\x01\x00\x00\x00\x01Z\x00\x01m\x1b#\xab'\xe1\x00\x00\x0f\xaf\x03]Jp\xded\x9f\xf6:Q\xa9L\xc9\x9f\xf7mV\xc4_\xfd\x9a*|\xb0\xeaJ?u\x0f\xac\xfb\xce\xb4t\xd7/\x15\x13\x91r\xd95N\xf8\x8a\xf6P\xaa4 O\xd2\xb3\xa6\x16\x9d\xea\x99\xa3+\x12q\x98\xf3\xbe)\x93\xba`\xcdW\xf2\x8b}\x1c_\x8ct\xef\x88\x00mA\xb8hB\xb5\xfb\xda\x98\xed\x8e\xaa.\x0c\x83\xe7)\xa4\xe0\x8b\xd5\xd6\xd7\xac\xa7\xaa\xf7'\xd0e\xd4O\x956\xcc\xff\x80\x1en\xcfZU\x9a;\xee\x8c\x10i\x0fO\x97\xcdAX\x96I\xad\xfc\x10\x18~\xd4p\xb4\x1e\x9a\xcc\xb4|\xa1\xe8*\x13b\xdb\xd9\xdcw\x83\x9f\x15\x06\xeb\xa1\x08\xa2m\xbfa\xfa\x95\xb4\xb0\xa6\x91m#\x06cMJ?\xb6Xn\x1ee.\xa9\xc0S#9q\x9e\x13o\xde\x1d\xd3\x0cb\x15\x92\x1f\x1ep\x95M\x03\xf5d\x19\xfa\x9f+\xf0\xbc!\xca\xb2\xdf,\xca\x1d\xe2v\x0c\x97\xe7v\x85_\xac]fn\xb4*\xd6`U\xf7\xd3\xf2g\xf7pQ\xdd5o\xcd\xc9q\t\xd7\xe1\r\xc4\x99JS'K#\x0e\x1e\x1f\x08\xe6j\xd7\x0fmR%\xd4Hb\xa9\x93\x0b\xb1\xea\x05\x8c\xf5r\x1e\xca\x83|D\xa8\x97\xc7\xa2\xb2\xa2\x97o/@\xe5\xbez7,w\xc0\xfdDR\xda\xa6MIM\x87\xb1\xc3\xf8\x85E\x9c\x9c"
Message hash: b'B\xeb\xecd#\xdd\xd9V\xdeV6Eb7\\B\xdc\xd1\xe8\t\\\xb8\xad\x02\xd0\x96{\xb0\xa2\xdfk\xad'
My random: 9f3db8fcb7beab66acdd3cd70fc47700
Temp key: b'\x11NE\x94\xf4;B\x1a\xbdf\xe6e\xc46\x11\x93r\xd5=W\x1aa\x88\xe7\xed\x94\x911\xebE\x91o'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01\xa1we\x14\xe8\xb4\x00\x00.\x03\x8d\xf7\x08\xf8R\xbb\xf8\xf3\xbd(\xf6KU\x1e\xff\xa8\xad\x8b_%S\xb9\xd5\x8ctZgt\xaa\xa0\xd2q\x99VR^\xb1\xf7\xec=r\xab\x97\xde\xb8\xf4\x16\xfe\xd1G\xfb2\xb5\x84\xbd\x96T5:\xff\x93\xa1\x1c\x02m6\xb7J\xbc\x18\x06\xc4\t\x15D\x90\x89\x81\xcb\xef\x01\xf8\x13\r\x85n1\xe3>\x84w\x84\x19\x9c\x95\xf7\x11\xc8\xc63Go\xfc\xff\xc9_\xa2'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01\xa1we\x14\xe8\xb4\x00\x00.\x03\x8d\xf7\x08\xf8R\xbb\xf8\xf3\xbd(\xf6KU\x1e\xff\xa8\xad\x8b_%S\xb9\xd5\x8ctZgt\xaa\xa0\xd2q\x99VR^\xb1\xf7\xec=r\xab\x97\xde\xb8\xf4\x16\xfe\xd1G\xfb2\xb5\x84\xbd\x96T5:\xff\x93\xa1\x1c\x02m6\xb7J\xbc\x18\x06\xc4\t\x15D\x90\x89\x81\xcb\xef\x01\xf8\x13\r\x85n1\xe3>\x84w\x84\x19\x9c\x95\xf7\x11\xc8\xc63Go\xfc\xff\xc9_\xa2'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xa1we\x14\xe8\xb4\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xf7\x11\xc8\xc63Go\xfc\xff\xc9_\xa2'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'42ebec6423ddd956de56364562375c42dcd1e8095cb8ad02d0967bb0a2df6bad\ne08f9085a1e8f0fff58d4279ed74decb'
DEBUG:SiFT_MTP:42ebec6423ddd956de56364562375c42dcd1e8095cb8ad02d0967bb0a2df6bad
e08f9085a1e8f0fff58d4279ed74decb
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xfa6\x03\xd4W\n,)eE\x06\xbb\xbaS\x9c`\x97+\xf4\x904\x06x\xeb\xc3\x15\x1bV\xd0\xc5AJ'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['mkd', 'test']
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xfa6\x03\xd4W\n,)eE\x06\xbb\xbaS\x9c`\x97+\xf4\x904\x06x\xeb\xc3\x15\x1bV\xd0\xc5AJ'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00$'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00$\x00\x02\xc0J\x87\r<\x93\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xaf\x1bo\x079\xb0\xd4:'
MAC: b'\xa2\xcdZ\x96\xd0\xf0\x86\xe7}FE\xa4'nonce b'\x00\x02\xc0J\x87\r<\x93'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00$\x00\x02\xc0J\x87\r<\x93\x00\x00\xaf\x1bo\x079\xb0\xd4:\xa2\xcdZ\x96\xd0\xf0\x86\xe7}FE\xa4'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00$\x00\x02\xc0J\x87\r<\x93\x00\x00\xaf\x1bo\x079\xb0\xd4:\xa2\xcdZ\x96\xd0\xf0\x86\xe7}FE\xa4'
Message hash: b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'

DEBUG:__main__:b'\x01\x00\x01\x00\x00$\x00\x02\xc0J\x87\r<\x93\x00\x00\xaf\x1bo\x079\xb0\xd4:\xa2\xcdZ\x96\xd0\xf0\x86\xe7}FE\xa4'
DEBUG:__main__:b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x02\xbfK\x10\xad#\x85\x00\x00#\xaf\xc9\xb3\xf6\xcd\xa0G\x8e\xe9\xd0\xfe\xd2\xbc\xd7\xe9\xf3\xecG\xd0\x83\x82\x8eg\xb8iu\xa6\xc8\xff\t}\xbf\x88\xda\xfb\xab\xcd\x945F\xfaiN\xb6|\xae?\x1d\x89.<2\xcaUe}jO!H\x91\xdd\xba\x1b\x89\x88@\xf9\xc1\xdb\x1a\xb9\xb7\x04y{\xe68$y$\xbf\xa9hj\xfb\x11f\x14\xb7\xa5o|\x1f\xacj%T\xfa\xb6\x191c\t\xe5\x8d\x90U\xae\xbc:\x82U|\x92\x9b\x171\x81{\xff\xd6\xbdKW\xb3>\nw'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x02\xbfK\x10\xad#\x85\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'1\x81{\xff\xd6\xbdKW\xb3>\nw'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"mkd\n8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:mkd
8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xfa6\x03\xd4W\n,)eE\x06\xbb\xbaS\x9c`\x97+\xf4\x904\x06x\xeb\xc3\x15\x1bV\xd0\xc5AJ'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x03\xf9\x08\x08\xf2X`\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xa9\x16\xdb'
MAC: b'\xfc\xc3S5\xce\xfa\xba\xfe\xee\xac)W'nonce b'\x00\x03\xf9\x08\x08\xf2X`'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x03\xf9\x08\x08\xf2X`\x00\x00\xa9\x16\xdb\xfc\xc3S5\xce\xfa\xba\xfe\xee\xac)W'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x03\xf9\x08\x08\xf2X`\x00\x00\xa9\x16\xdb\xfc\xc3S5\xce\xfa\xba\xfe\xee\xac)W'
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x03\xf9\x08\x08\xf2X`\x00\x00\xa9\x16\xdb\xfc\xc3S5\xce\xfa\xba\xfe\xee\xac)W'
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00n\x00\x03\xbfK\x10\xad#\x85\x00\x00\x8f\xf9\x95\x88&\x0c\x06\x1f\xdb\xe7T\xf1+\x1dW\x7f"X\x9dbc\x89\xfa1\x8at\xd4\r<\xb5\x8c\x8f\xf3\xca#X\xc4\xe3\xb8\xbe\xa8\xf7\xc6nW\x85\xa7\xff\x06\xd4\xc7\x046\x8d\x10=\x1b\x95\xba\x8eu\xd7\xfc\xf6\xc6\xeb\xd0\x16\x9b\xd4o\x89\xc6\xa7\x1e\x801KARn\x1a\x8a\xf8\x00|RG\x95\x1e3t\x83\x0b'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00n\x00\x03\xbfK\x10\xad#\x85\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x8a\xf8\x00|RG\x95\x1e3t\x83\x0b'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess\ntest1'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
test1
DEBUG:__main__:command_format
DEBUG:__main__:chd
test1
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xfa6\x03\xd4W\n,)eE\x06\xbb\xbaS\x9c`\x97+\xf4\x904\x06x\xeb\xc3\x15\x1bV\xd0\xc5AJ'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
test1
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x04\xac\xceK\x1eg]\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b"k\x9d!\xe2r'\x1f\x9e\xfc"
MAC: b'\x9a+K\xe0\x8aI\x98\xe0\xee\xf0\xe9H'nonce b'\x00\x04\xac\xceK\x1eg]'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b"\x01\x00\x01\x00\x00%\x00\x04\xac\xceK\x1eg]\x00\x00k\x9d!\xe2r'\x1f\x9e\xfc\x9a+K\xe0\x8aI\x98\xe0\xee\xf0\xe9H"
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 2701e10f4a98c240dfa00da1922b3a523bba2040f152694552bb1748c1f4ff51
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b"\x01\x00\x01\x00\x00%\x00\x04\xac\xceK\x1eg]\x00\x00k\x9d!\xe2r'\x1f\x9e\xfc\x9a+K\xe0\x8aI\x98\xe0\xee\xf0\xe9H"
Message hash: b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"

DEBUG:__main__:b"\x01\x00\x01\x00\x00%\x00\x04\xac\xceK\x1eg]\x00\x00k\x9d!\xe2r'\x1f\x9e\xfc\x9a+K\xe0\x8aI\x98\xe0\xee\xf0\xe9H"
DEBUG:__main__:b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"
INFO:__main__:Message sent!
ERROR:__main__:An error was occurred during the process: [WinError 10054] An existing connection was forcibly closed by the remote host
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134443887079500
alice
aaa
521ad1b3b11d365689c139d2b729ee01
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134443887079500
alice
aaa
521ad1b3b11d365689c139d2b729ee01
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01u\xd3\xaa\xc8\x0c\xfd\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\xeb\x18S\xb5I\xbc\xbdq\x15\xa9\x0e\x90'nonce b'\x00\x01u\xd3\xaa\xc8\x0c\xfd'
tk: b'\xb6\x13P\x1c^o\xa2\xd1J\x83\xe3\x10\xad{\x0c\xaf\xac\x11qxU\xa3\xcc\x1e\xef\xb5q\xf8a`\xe3*'
encrypted payload: b'\x88 TW\xac-\x8c\nn\xf9w!N\nY{~\x1d\x11{\x9e\x8c\xde\x1e]W\x0c`\xd2\xd0\xde\xf3d\x9b\x07\xd9\x9f\xa9\xc5\xfc.d"\ni(\xac\xbbm=\xe1k|\xa0p\xf11\xdd\x99\xb4\xce\xb0'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'\x84h\x9b\x1fHhB\xd01C\'\xe7u\x80\x97\x99\xed\xfe\x86\x80\xee\xe1\xe4\xdd\x92\xd4\xc4:fT\xee=\x17,8\x8d\x86Z\x85\x17\xec5\x96\xe4#\xba\x9b\xc4\xa4s\xc2B\xe2\xa3\xa8\xe0\x96\xa5"(5z\xe9\x03\x86\',\xe6bw\xcd\x8e\xd3\xfe\xd8@\x8f\x89\xf6|\xa5\xd7I]v\xac$@]\xd1\x19\x00*\xdc\x88\x0e\xeep\xe2\xe8V\x19\x95\x18\xaf\xec 2>\xb1^\xe7F5{i\xd7\xc7\x8as$)o$d\xa7\xae\xd70v\x1dd~\x08MV\x8fP\xfe\xec\xf1^\x90.\x96\xd3\xfc\x03\xff>\xb0\x14\x9eY=\xee\x0b?jXGk\x07\xc4K\x94b5~w\xb2\r\xa7\xab\xea\xfa3%\x1b\xf9\x18HK\xac\xed*\x98^\xb4\x99d\xbd\xf2nn\x90 \xbd\x1f\x04\xe5JU8\xe7\x12\xd6TF\xbe\xaa\xca\x11\x8d\x00\x17\xa7\xc8T\xa8\x16\x93\x04\x17GS\xca\x83\xf7\x17\xaf\x90\xd4\xfa\xb5\xe0S\xba/\x8c\xd2\xbe\x84\x81\xff\x97O\xd5\x05\xb3\x82\xe5\xee a\xba'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01u\xd3\xaa\xc8\x0c\xfd\x00\x00\x88 TW\xac-\x8c\nn\xf9w!N\nY{~\x1d\x11{\x9e\x8c\xde\x1e]W\x0c`\xd2\xd0\xde\xf3d\x9b\x07\xd9\x9f\xa9\xc5\xfc.d"\ni(\xac\xbbm=\xe1k|\xa0p\xf11\xdd\x99\xb4\xce\xb0\xeb\x18S\xb5I\xbc\xbdq\x15\xa9\x0e\x90\x84h\x9b\x1fHhB\xd01C\'\xe7u\x80\x97\x99\xed\xfe\x86\x80\xee\xe1\xe4\xdd\x92\xd4\xc4:fT\xee=\x17,8\x8d\x86Z\x85\x17\xec5\x96\xe4#\xba\x9b\xc4\xa4s\xc2B\xe2\xa3\xa8\xe0\x96\xa5"(5z\xe9\x03\x86\',\xe6bw\xcd\x8e\xd3\xfe\xd8@\x8f\x89\xf6|\xa5\xd7I]v\xac$@]\xd1\x19\x00*\xdc\x88\x0e\xeep\xe2\xe8V\x19\x95\x18\xaf\xec 2>\xb1^\xe7F5{i\xd7\xc7\x8as$)o$d\xa7\xae\xd70v\x1dd~\x08MV\x8fP\xfe\xec\xf1^\x90.\x96\xd3\xfc\x03\xff>\xb0\x14\x9eY=\xee\x0b?jXGk\x07\xc4K\x94b5~w\xb2\r\xa7\xab\xea\xfa3%\x1b\xf9\x18HK\xac\xed*\x98^\xb4\x99d\xbd\xf2nn\x90 \xbd\x1f\x04\xe5JU8\xe7\x12\xd6TF\xbe\xaa\xca\x11\x8d\x00\x17\xa7\xc8T\xa8\x16\x93\x04\x17GS\xca\x83\xf7\x17\xaf\x90\xd4\xfa\xb5\xe0S\xba/\x8c\xd2\xbe\x84\x81\xff\x97O\xd5\x05\xb3\x82\xe5\xee a\xba'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01u\xd3\xaa\xc8\x0c\xfd\x00\x00\x88 TW\xac-\x8c\nn\xf9w!N\nY{~\x1d\x11{\x9e\x8c\xde\x1e]W\x0c`\xd2\xd0\xde\xf3d\x9b\x07\xd9\x9f\xa9\xc5\xfc.d"\ni(\xac\xbbm=\xe1k|\xa0p\xf11\xdd\x99\xb4\xce\xb0\xeb\x18S\xb5I\xbc\xbdq\x15\xa9\x0e\x90\x84h\x9b\x1fHhB\xd01C\'\xe7u\x80\x97\x99\xed\xfe\x86\x80\xee\xe1\xe4\xdd\x92\xd4\xc4:fT\xee=\x17,8\x8d\x86Z\x85\x17\xec5\x96\xe4#\xba\x9b\xc4\xa4s\xc2B\xe2\xa3\xa8\xe0\x96\xa5"(5z\xe9\x03\x86\',\xe6bw\xcd\x8e\xd3\xfe\xd8@\x8f\x89\xf6|\xa5\xd7I]v\xac$@]\xd1\x19\x00*\xdc\x88\x0e\xeep\xe2\xe8V\x19\x95\x18\xaf\xec 2>\xb1^\xe7F5{i\xd7\xc7\x8as$)o$d\xa7\xae\xd70v\x1dd~\x08MV\x8fP\xfe\xec\xf1^\x90.\x96\xd3\xfc\x03\xff>\xb0\x14\x9eY=\xee\x0b?jXGk\x07\xc4K\x94b5~w\xb2\r\xa7\xab\xea\xfa3%\x1b\xf9\x18HK\xac\xed*\x98^\xb4\x99d\xbd\xf2nn\x90 \xbd\x1f\x04\xe5JU8\xe7\x12\xd6TF\xbe\xaa\xca\x11\x8d\x00\x17\xa7\xc8T\xa8\x16\x93\x04\x17GS\xca\x83\xf7\x17\xaf\x90\xd4\xfa\xb5\xe0S\xba/\x8c\xd2\xbe\x84\x81\xff\x97O\xd5\x05\xb3\x82\xe5\xee a\xba'
DEBUG:SiFT_MTP:TK from MTP: b'\xb6\x13P\x1c^o\xa2\xd1J\x83\xe3\x10\xad{\x0c\xaf\xac\x11qxU\xa3\xcc\x1e\xef\xb5q\xf8a`\xe3*'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: ea36c5d9d0619b5f6407431aed38523df331577111a0113f84031cad26724ac7
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01u\xd3\xaa\xc8\x0c\xfd\x00\x00\x88 TW\xac-\x8c\nn\xf9w!N\nY{~\x1d\x11{\x9e\x8c\xde\x1e]W\x0c`\xd2\xd0\xde\xf3d\x9b\x07\xd9\x9f\xa9\xc5\xfc.d"\ni(\xac\xbbm=\xe1k|\xa0p\xf11\xdd\x99\xb4\xce\xb0\xeb\x18S\xb5I\xbc\xbdq\x15\xa9\x0e\x90\x84h\x9b\x1fHhB\xd01C\'\xe7u\x80\x97\x99\xed\xfe\x86\x80\xee\xe1\xe4\xdd\x92\xd4\xc4:fT\xee=\x17,8\x8d\x86Z\x85\x17\xec5\x96\xe4#\xba\x9b\xc4\xa4s\xc2B\xe2\xa3\xa8\xe0\x96\xa5"(5z\xe9\x03\x86\',\xe6bw\xcd\x8e\xd3\xfe\xd8@\x8f\x89\xf6|\xa5\xd7I]v\xac$@]\xd1\x19\x00*\xdc\x88\x0e\xeep\xe2\xe8V\x19\x95\x18\xaf\xec 2>\xb1^\xe7F5{i\xd7\xc7\x8as$)o$d\xa7\xae\xd70v\x1dd~\x08MV\x8fP\xfe\xec\xf1^\x90.\x96\xd3\xfc\x03\xff>\xb0\x14\x9eY=\xee\x0b?jXGk\x07\xc4K\x94b5~w\xb2\r\xa7\xab\xea\xfa3%\x1b\xf9\x18HK\xac\xed*\x98^\xb4\x99d\xbd\xf2nn\x90 \xbd\x1f\x04\xe5JU8\xe7\x12\xd6TF\xbe\xaa\xca\x11\x8d\x00\x17\xa7\xc8T\xa8\x16\x93\x04\x17GS\xca\x83\xf7\x17\xaf\x90\xd4\xfa\xb5\xe0S\xba/\x8c\xd2\xbe\x84\x81\xff\x97O\xd5\x05\xb3\x82\xe5\xee a\xba'
Message hash: b'\xea6\xc5\xd9\xd0a\x9b_d\x07C\x1a\xed8R=\xf31Wq\x11\xa0\x11?\x84\x03\x1c\xad&rJ\xc7'
My random: 521ad1b3b11d365689c139d2b729ee01
Temp key: b'\xb6\x13P\x1c^o\xa2\xd1J\x83\xe3\x10\xad{\x0c\xaf\xac\x11qxU\xa3\xcc\x1e\xef\xb5q\xf8a`\xe3*'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b"\x01\x00\x00\x10\x00}\x00\x01nY1\xdb\xc2(\x00\x00\xe9\xeb\xfbU\x88x7\xe7\x84\x84\xbatdX\x00\xf4;\x02z\x16\x9be\x11\xce\xeb\xe8\x81j\xef\xad.K\xa7\x9e\xdd>\xae\xd8\xa8\xd5\xe9\xe8%\xcdN\xc1\xdbI$\xc5[3\xc2\x0e\xe5\xfb\xc9\xf0\x9e\x81\xb5\xe0\xc4y[\x93\xa6\\\xd7\x8c~\x08\xd6\xe9Q\x83\xa0i\xc7)\xbe\xa9\x94i\xbf\xbf\x8e%\x9e\xa3\xb1\xa6\xe5:\x0b\xb1\xa3\x85'!\xd46`\xadB\xe8\xd3T\xde"
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b"\x01\x00\x00\x10\x00}\x00\x01nY1\xdb\xc2(\x00\x00\xe9\xeb\xfbU\x88x7\xe7\x84\x84\xbatdX\x00\xf4;\x02z\x16\x9be\x11\xce\xeb\xe8\x81j\xef\xad.K\xa7\x9e\xdd>\xae\xd8\xa8\xd5\xe9\xe8%\xcdN\xc1\xdbI$\xc5[3\xc2\x0e\xe5\xfb\xc9\xf0\x9e\x81\xb5\xe0\xc4y[\x93\xa6\\\xd7\x8c~\x08\xd6\xe9Q\x83\xa0i\xc7)\xbe\xa9\x94i\xbf\xbf\x8e%\x9e\xa3\xb1\xa6\xe5:\x0b\xb1\xa3\x85'!\xd46`\xadB\xe8\xd3T\xde"
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01nY1\xdb\xc2(\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b"\x85'!\xd46`\xadB\xe8\xd3T\xde"
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'ea36c5d9d0619b5f6407431aed38523df331577111a0113f84031cad26724ac7\n82519ce31099b11c671e859679906e0c'
DEBUG:SiFT_MTP:ea36c5d9d0619b5f6407431aed38523df331577111a0113f84031cad26724ac7
82519ce31099b11c671e859679906e0c
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xf6<\xb9wU\x0e\x91aYQ\xfd\x07\x0b\x92cc\x9dD\x98\x11\x8a/9\x81H\x88\xc8>\xe1\xb6\xc1\x94'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['pwd']
DEBUG:__main__:command_format
DEBUG:__main__:pwd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf6<\xb9wU\x0e\x91aYQ\xfd\x07\x0b\x92cc\x9dD\x98\x11\x8a/9\x81H\x88\xc8>\xe1\xb6\xc1\x94'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:pwd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xb3\xe0fY}_\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xc4\x97\x1e'
MAC: b'1\x84i\xcb\xda\xcbe\x06=?P}'nonce b'\x00\x02\xb3\xe0fY}_'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x02\xb3\xe0fY}_\x00\x00\xc4\x97\x1e1\x84i\xcb\xda\xcbe\x06=?P}'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x02\xb3\xe0fY}_\x00\x00\xc4\x97\x1e1\x84i\xcb\xda\xcbe\x06=?P}'
Message hash: b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x02\xb3\xe0fY}_\x00\x00\xc4\x97\x1e1\x84i\xcb\xda\xcbe\x06=?P}'
DEBUG:__main__:b'\xa1\x15\x9e\x9d\xf3g\rT\x9d\x04RE2b\x9fTw\xce\xb7\xde\xec\x9bE\xe4~\x8c\x00\x95\x06\xec\xb2\xc8'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00k\x00\x02z\xa5\xf6\x9b\r\xeb\x00\x00\xc4\x97/\xe343[J\xe0\xfd}\x02q\xe2\xdbXG\xac0\xea\xd4c\x9b\xee\xc9\xd1\x00\xbd\xe9\x8c\xe9\xacQ.I\xb4T\xd0\xfb\xb1\xe30\x06\xb7\xf1\xb1.\xce.ot\x12`L\x95\xb2\xe7\xde~\xa0\x9f\xca\xbd\xd7\xafiQ\x90)\x93k\x113\xae\xa9Tyl\x00\xfeJ\x1f\x02\x89\xe4\xcbE\x1d\xb5{\x9d'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00k\x00\x02z\xa5\xf6\x9b\r\xeb\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xfeJ\x1f\x02\x89\xe4\xcbE\x1d\xb5{\x9d'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'pwd\na1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8\nsuccess\n~/'
DEBUG:SiFT_MTP:pwd
a1159e9df3670d549d04524532629f5477ceb7deec9b45e47e8c009506ecb2c8
success
~/
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf6<\xb9wU\x0e\x91aYQ\xfd\x07\x0b\x92cc\x9dD\x98\x11\x8a/9\x81H\x88\xc8>\xe1\xb6\xc1\x94'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x036\x06N\xe0\xd64\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xddKu'
MAC: b'l\x1c\xfa1:\xd3\xb7bK\xff\xb1^'nonce b'\x00\x036\x06N\xe0\xd64'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x036\x06N\xe0\xd64\x00\x00\xddKul\x1c\xfa1:\xd3\xb7bK\xff\xb1^'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x036\x06N\xe0\xd64\x00\x00\xddKul\x1c\xfa1:\xd3\xb7bK\xff\xb1^'
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x036\x06N\xe0\xd64\x00\x00\xddKul\x1c\xfa1:\xd3\xb7bK\xff\xb1^'
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00n\x00\x03z\xa5\xf6\x9b\r\xeb\x00\x00\xf1\xb8\xfd\xdaK\xcd\xb1K\x8e\x0c\x03\xae\xe4\xb5s^\x8a\x88*\x9a\xcf\x92\x1c\xce\x88;\xe8z\xb2\xfd\x0fbO}\xaex>[r\xa2\x00\xcc4B\xb6S\xb85\xc7#\xe0\xff\x9f9H\xa2\xa1\x1fx\xdc\x05\x96\xea\x8f\t&U\nO\xd6;[\xc8B\x9b\xd0\x1c`\xc9#g\x12\x10\xc582\xfa3\x08\xc7.\x8d$\xf1'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00n\x00\x03z\xa5\xf6\x9b\r\xeb\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x10\xc582\xfa3\x08\xc7.\x8d$\xf1'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess\ntest1'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
test1
DEBUG:__main__:command_format
DEBUG:__main__:chd
test1
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf6<\xb9wU\x0e\x91aYQ\xfd\x07\x0b\x92cc\x9dD\x98\x11\x8a/9\x81H\x88\xc8>\xe1\xb6\xc1\x94'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
test1
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x04H_5\xfdkD\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b']\x11\xeaL\xa1mM\xd5\x15'
MAC: b"\xb8Q^\xbf'\xb1]Ch8l\x9d"nonce b'\x00\x04H_5\xfdkD'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b"\x01\x00\x01\x00\x00%\x00\x04H_5\xfdkD\x00\x00]\x11\xeaL\xa1mM\xd5\x15\xb8Q^\xbf'\xb1]Ch8l\x9d"
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 2701e10f4a98c240dfa00da1922b3a523bba2040f152694552bb1748c1f4ff51
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b"\x01\x00\x01\x00\x00%\x00\x04H_5\xfdkD\x00\x00]\x11\xeaL\xa1mM\xd5\x15\xb8Q^\xbf'\xb1]Ch8l\x9d"
Message hash: b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"

DEBUG:__main__:b"\x01\x00\x01\x00\x00%\x00\x04H_5\xfdkD\x00\x00]\x11\xeaL\xa1mM\xd5\x15\xb8Q^\xbf'\xb1]Ch8l\x9d"
DEBUG:__main__:b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"
INFO:__main__:Message sent!
ERROR:__main__:An error was occurred during the process: [WinError 10054] An existing connection was forcibly closed by the remote host
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134488675447400
alice
aaa
d0afd2193ff751041d60678f9dd07d2c
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134488675447400
alice
aaa
d0afd2193ff751041d60678f9dd07d2c
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01\xd9\xf7\xb7\xb9&p\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'q\x8c\xe1\xe8\x10!In\xc0\xbeJ\xa6'nonce b'\x00\x01\xd9\xf7\xb7\xb9&p'
tk: b'\x8dP\xfbp\x8eK\xce\x08\xad\x07\xd1\xff"\xba\xc8\xb9\xdb\xc9\x06\x9d\x07#{\xbfEc\xf8l\xacr\xbb\xf7'
encrypted payload: b'n!\x02-\xd1*s\xc0\x99\x83\x14\xdf\xae$\x9f#\xe6\xf3\x13J\xee\x98\xdc\x08\xc4t=\xe71i\xed\x91\xbb\x80JW\x1a\xd8\x85\x12\xc9\xc8\x0f\x049\x90\xd6\xc2c\xe1\x06W\x7f\xa7\x91\xc5h\x1e\xcc\xab\xc6\xf6'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'q\xa7\xa2\xe7b\x03!sc(E\xc6\xaf\xd0L\x7f\xa4\x0f\xdb\xab\xb2\xfdM\xa5\x00\x9f\t\xac\xdf\x9dP\xae1K\xf1\xe3\xfa\x93\xb88A\x0b\xb1N\x06i\xb8o\x97l4/\xe3\xbc\x94"\x81\xaf\xd0Y\x0b\xaf9\xb64\x0b\xde\x04\\g~4T7\xa0\x8b\xe0g\xa7\x02\xd0\xec\x89R\xbb\xd8\x821\xe3\xf6\xc0Q\xfb\xba\x14R\x7fGL\xf5i\xac\x1c\xef\x8d\xea\xb3\xabI\xd4L\x1e\x07\xb9\x01\x8a\xa2v\xa0\xe4\xe6\xe5\xdbQ\x07\xb4\x01\x8b\xed#\xa3\xbe}\x0b\x14\x1d3H\x8evO\xe7lw\x9fd\x91\xa2\xcd\xde\x1c\x87\xc6\x0e*\x84{\xed\xe2+\x13C\x8de\xc7\xd7\x04r\x9fe\xf6\xc7\x06\xb5\x9fH\xbe\x8d\x85\xda\x19\xe572\x8b\xad*\xed\xfb\x10\xa1\xeb&\x1e\xcbC\xf5\xe3T\xa2\t\xd5\x18S\xab\xae/\xcd\xeagQ\x03\xbb\xb2\xc9)E\xbe\x92\x90\xb6\xb1\xbb\xde\x87RR\xe8o{\xec\x15\xe3\xb6\xc3Vgu\xd4\x9f\xac\x143l\x9f\xd9\n\x08\xb4\xb7\x92\xd3z\xf7\xe6\x9a'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01\xd9\xf7\xb7\xb9&p\x00\x00n!\x02-\xd1*s\xc0\x99\x83\x14\xdf\xae$\x9f#\xe6\xf3\x13J\xee\x98\xdc\x08\xc4t=\xe71i\xed\x91\xbb\x80JW\x1a\xd8\x85\x12\xc9\xc8\x0f\x049\x90\xd6\xc2c\xe1\x06W\x7f\xa7\x91\xc5h\x1e\xcc\xab\xc6\xf6q\x8c\xe1\xe8\x10!In\xc0\xbeJ\xa6q\xa7\xa2\xe7b\x03!sc(E\xc6\xaf\xd0L\x7f\xa4\x0f\xdb\xab\xb2\xfdM\xa5\x00\x9f\t\xac\xdf\x9dP\xae1K\xf1\xe3\xfa\x93\xb88A\x0b\xb1N\x06i\xb8o\x97l4/\xe3\xbc\x94"\x81\xaf\xd0Y\x0b\xaf9\xb64\x0b\xde\x04\\g~4T7\xa0\x8b\xe0g\xa7\x02\xd0\xec\x89R\xbb\xd8\x821\xe3\xf6\xc0Q\xfb\xba\x14R\x7fGL\xf5i\xac\x1c\xef\x8d\xea\xb3\xabI\xd4L\x1e\x07\xb9\x01\x8a\xa2v\xa0\xe4\xe6\xe5\xdbQ\x07\xb4\x01\x8b\xed#\xa3\xbe}\x0b\x14\x1d3H\x8evO\xe7lw\x9fd\x91\xa2\xcd\xde\x1c\x87\xc6\x0e*\x84{\xed\xe2+\x13C\x8de\xc7\xd7\x04r\x9fe\xf6\xc7\x06\xb5\x9fH\xbe\x8d\x85\xda\x19\xe572\x8b\xad*\xed\xfb\x10\xa1\xeb&\x1e\xcbC\xf5\xe3T\xa2\t\xd5\x18S\xab\xae/\xcd\xeagQ\x03\xbb\xb2\xc9)E\xbe\x92\x90\xb6\xb1\xbb\xde\x87RR\xe8o{\xec\x15\xe3\xb6\xc3Vgu\xd4\x9f\xac\x143l\x9f\xd9\n\x08\xb4\xb7\x92\xd3z\xf7\xe6\x9a'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01\xd9\xf7\xb7\xb9&p\x00\x00n!\x02-\xd1*s\xc0\x99\x83\x14\xdf\xae$\x9f#\xe6\xf3\x13J\xee\x98\xdc\x08\xc4t=\xe71i\xed\x91\xbb\x80JW\x1a\xd8\x85\x12\xc9\xc8\x0f\x049\x90\xd6\xc2c\xe1\x06W\x7f\xa7\x91\xc5h\x1e\xcc\xab\xc6\xf6q\x8c\xe1\xe8\x10!In\xc0\xbeJ\xa6q\xa7\xa2\xe7b\x03!sc(E\xc6\xaf\xd0L\x7f\xa4\x0f\xdb\xab\xb2\xfdM\xa5\x00\x9f\t\xac\xdf\x9dP\xae1K\xf1\xe3\xfa\x93\xb88A\x0b\xb1N\x06i\xb8o\x97l4/\xe3\xbc\x94"\x81\xaf\xd0Y\x0b\xaf9\xb64\x0b\xde\x04\\g~4T7\xa0\x8b\xe0g\xa7\x02\xd0\xec\x89R\xbb\xd8\x821\xe3\xf6\xc0Q\xfb\xba\x14R\x7fGL\xf5i\xac\x1c\xef\x8d\xea\xb3\xabI\xd4L\x1e\x07\xb9\x01\x8a\xa2v\xa0\xe4\xe6\xe5\xdbQ\x07\xb4\x01\x8b\xed#\xa3\xbe}\x0b\x14\x1d3H\x8evO\xe7lw\x9fd\x91\xa2\xcd\xde\x1c\x87\xc6\x0e*\x84{\xed\xe2+\x13C\x8de\xc7\xd7\x04r\x9fe\xf6\xc7\x06\xb5\x9fH\xbe\x8d\x85\xda\x19\xe572\x8b\xad*\xed\xfb\x10\xa1\xeb&\x1e\xcbC\xf5\xe3T\xa2\t\xd5\x18S\xab\xae/\xcd\xeagQ\x03\xbb\xb2\xc9)E\xbe\x92\x90\xb6\xb1\xbb\xde\x87RR\xe8o{\xec\x15\xe3\xb6\xc3Vgu\xd4\x9f\xac\x143l\x9f\xd9\n\x08\xb4\xb7\x92\xd3z\xf7\xe6\x9a'
DEBUG:SiFT_MTP:TK from MTP: b'\x8dP\xfbp\x8eK\xce\x08\xad\x07\xd1\xff"\xba\xc8\xb9\xdb\xc9\x06\x9d\x07#{\xbfEc\xf8l\xacr\xbb\xf7'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 2bac121067169be69853e3a31e24da20c061e8bb45e40d49d021762e56695864
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01\xd9\xf7\xb7\xb9&p\x00\x00n!\x02-\xd1*s\xc0\x99\x83\x14\xdf\xae$\x9f#\xe6\xf3\x13J\xee\x98\xdc\x08\xc4t=\xe71i\xed\x91\xbb\x80JW\x1a\xd8\x85\x12\xc9\xc8\x0f\x049\x90\xd6\xc2c\xe1\x06W\x7f\xa7\x91\xc5h\x1e\xcc\xab\xc6\xf6q\x8c\xe1\xe8\x10!In\xc0\xbeJ\xa6q\xa7\xa2\xe7b\x03!sc(E\xc6\xaf\xd0L\x7f\xa4\x0f\xdb\xab\xb2\xfdM\xa5\x00\x9f\t\xac\xdf\x9dP\xae1K\xf1\xe3\xfa\x93\xb88A\x0b\xb1N\x06i\xb8o\x97l4/\xe3\xbc\x94"\x81\xaf\xd0Y\x0b\xaf9\xb64\x0b\xde\x04\\g~4T7\xa0\x8b\xe0g\xa7\x02\xd0\xec\x89R\xbb\xd8\x821\xe3\xf6\xc0Q\xfb\xba\x14R\x7fGL\xf5i\xac\x1c\xef\x8d\xea\xb3\xabI\xd4L\x1e\x07\xb9\x01\x8a\xa2v\xa0\xe4\xe6\xe5\xdbQ\x07\xb4\x01\x8b\xed#\xa3\xbe}\x0b\x14\x1d3H\x8evO\xe7lw\x9fd\x91\xa2\xcd\xde\x1c\x87\xc6\x0e*\x84{\xed\xe2+\x13C\x8de\xc7\xd7\x04r\x9fe\xf6\xc7\x06\xb5\x9fH\xbe\x8d\x85\xda\x19\xe572\x8b\xad*\xed\xfb\x10\xa1\xeb&\x1e\xcbC\xf5\xe3T\xa2\t\xd5\x18S\xab\xae/\xcd\xeagQ\x03\xbb\xb2\xc9)E\xbe\x92\x90\xb6\xb1\xbb\xde\x87RR\xe8o{\xec\x15\xe3\xb6\xc3Vgu\xd4\x9f\xac\x143l\x9f\xd9\n\x08\xb4\xb7\x92\xd3z\xf7\xe6\x9a'
Message hash: b'+\xac\x12\x10g\x16\x9b\xe6\x98S\xe3\xa3\x1e$\xda \xc0a\xe8\xbbE\xe4\rI\xd0!v.ViXd'
My random: d0afd2193ff751041d60678f9dd07d2c
Temp key: b'\x8dP\xfbp\x8eK\xce\x08\xad\x07\xd1\xff"\xba\xc8\xb9\xdb\xc9\x06\x9d\x07#{\xbfEc\xf8l\xacr\xbb\xf7'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01\xc7\xa8\xb4\x05\xc7\x97\x00\x00\x0c\x17\xb0\x15\x8bt\xfa\x88\xaem\xea\xac{O\xb0\xb5I\xb5\xebO\x99GtK\x9d`\xa2T\x02\xb2I\x99Tw\xba*\x07aB\xbe\xe1\xf8\x7f\x13]\xed\x0f\xbc\x84\x83V\x95U\xe3.\xe2\x92\xfeGW\xde\x17\xf7\x91\x030\x94I\xb6\x89\xfa\n\x9d(\xe0gO".,>DY8\xb7q\xfdeM0xb\xb06\xc8\x00~\xe7\x9a\xb6\xb5\xeePgbJcS\xa2'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01\xc7\xa8\xb4\x05\xc7\x97\x00\x00\x0c\x17\xb0\x15\x8bt\xfa\x88\xaem\xea\xac{O\xb0\xb5I\xb5\xebO\x99GtK\x9d`\xa2T\x02\xb2I\x99Tw\xba*\x07aB\xbe\xe1\xf8\x7f\x13]\xed\x0f\xbc\x84\x83V\x95U\xe3.\xe2\x92\xfeGW\xde\x17\xf7\x91\x030\x94I\xb6\x89\xfa\n\x9d(\xe0gO".,>DY8\xb7q\xfdeM0xb\xb06\xc8\x00~\xe7\x9a\xb6\xb5\xeePgbJcS\xa2'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xc7\xa8\xb4\x05\xc7\x97\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xe7\x9a\xb6\xb5\xeePgbJcS\xa2'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'2bac121067169be69853e3a31e24da20c061e8bb45e40d49d021762e56695864\n71157e8c15b2a4dc91801d472aacbc46'
DEBUG:SiFT_MTP:2bac121067169be69853e3a31e24da20c061e8bb45e40d49d021762e56695864
71157e8c15b2a4dc91801d472aacbc46
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['chd', 'test1']
DEBUG:__main__:command_format
DEBUG:__main__:chd
test1
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
test1
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x02\x02>t\x84:\xb1\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x12\xfbP\xdf\xd8\xf2/+.'
MAC: b'e\xc4\xcd\xd5S\xf3A]l\xea\xdb\xa0'nonce b'\x00\x02\x02>t\x84:\xb1'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00%\x00\x02\x02>t\x84:\xb1\x00\x00\x12\xfbP\xdf\xd8\xf2/+.e\xc4\xcd\xd5S\xf3A]l\xea\xdb\xa0'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 2701e10f4a98c240dfa00da1922b3a523bba2040f152694552bb1748c1f4ff51
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00%\x00\x02\x02>t\x84:\xb1\x00\x00\x12\xfbP\xdf\xd8\xf2/+.e\xc4\xcd\xd5S\xf3A]l\xea\xdb\xa0'
Message hash: b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"

DEBUG:__main__:b'\x01\x00\x01\x00\x00%\x00\x02\x02>t\x84:\xb1\x00\x00\x12\xfbP\xdf\xd8\xf2/+.e\xc4\xcd\xd5S\xf3A]l\xea\xdb\xa0'
DEBUG:__main__:b"'\x01\xe1\x0fJ\x98\xc2@\xdf\xa0\r\xa1\x92+:R;\xba @\xf1RiER\xbb\x17H\xc1\xf4\xffQ"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x02\x0f\x1b\x88\x86\x9c~\x00\x00\x90k\xf3Y\xaa+{%\xabp\x90*\xcek\xf4(\xe0\x12\x01\xfb\xfa\xd4\n\xbd\xfd\x9f\x00\x9d\xceOC\x08\xe9\xd7\x92\xca\xafnQ\xf9\x83Yb-\x8a\xd8\xa5Q;\x93\xe5\'4Z\x12}$=\x91\x1f\x18T:\x96\x82\xd3\xd2\x03XS#"\n\x02?7i\xfb/\x14\xdeG\n\xc3\xe7v<\xf9q\xf4R\xd6\xc2\x92\x9a\xb0\r\x89\xf0\xa2A\xf3C\xd6\x8d\xc5\xf9\xb9b\x87\xbf\xf76G\xbd0\xd5r\n~\x930 >8\xc7>1\xd7\x02'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x02\x0f\x1b\x88\x86\x9c~\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\n~\x930 >8\xc7>1\xd7\x02'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"chd\n2701e10f4a98c240dfa00da1922b3a523bba2040f152694552bb1748c1f4ff51\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:chd
2701e10f4a98c240dfa00da1922b3a523bba2040f152694552bb1748c1f4ff51
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test4
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test4
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x03\xcd\xb4\x80\x1b\xe94\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x0e\xf86U\xe1\x85\x01\xe7y'
MAC: b'\x7f\xd5\x85\x13\xc0 \xee\xb0=;\xf3\x18'nonce b'\x00\x03\xcd\xb4\x80\x1b\xe94'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00%\x00\x03\xcd\xb4\x80\x1b\xe94\x00\x00\x0e\xf86U\xe1\x85\x01\xe7y\x7f\xd5\x85\x13\xc0 \xee\xb0=;\xf3\x18'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: d6d1ffe5d2df308a5212a3c8e93e0eb6be36c94dc19a2647e45d9129dd30772a
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00%\x00\x03\xcd\xb4\x80\x1b\xe94\x00\x00\x0e\xf86U\xe1\x85\x01\xe7y\x7f\xd5\x85\x13\xc0 \xee\xb0=;\xf3\x18'
Message hash: b'\xd6\xd1\xff\xe5\xd2\xdf0\x8aR\x12\xa3\xc8\xe9>\x0e\xb6\xbe6\xc9M\xc1\x9a&G\xe4]\x91)\xdd0w*'

DEBUG:__main__:b'\x01\x00\x01\x00\x00%\x00\x03\xcd\xb4\x80\x1b\xe94\x00\x00\x0e\xf86U\xe1\x85\x01\xe7y\x7f\xd5\x85\x13\xc0 \xee\xb0=;\xf3\x18'
DEBUG:__main__:b'\xd6\xd1\xff\xe5\xd2\xdf0\x8aR\x12\xa3\xc8\xe9>\x0e\xb6\xbe6\xc9M\xc1\x9a&G\xe4]\x91)\xdd0w*'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x03\x0f\x1b\x88\x86\x9c~\x00\x00\x96[\xb5qQ\xcc6\x075\xc8\xb41x\xbe\xb10\x17\x95Q\xda\xa4\x07\xd2\x96\xb5\x0c\xfbQ\xb6l\xb2\\ \xf7\xe3\xcd\xb6\x8a\xb7d]\x16\x19X\xbb\xe4J\x08\xf7R\xcd\xba\xc9R\xf1})\xcdD\x02\x88\x91\xfc\t\x07\xfd\xaa\xea\xc4\x8c}\xac7\x0c\x1d\x04^KT\x9cp\xdeQM\xe9B}\xf0)\xa7H\xcaa|\x04&\xd3\x11\x1e\xee\xe4\x1a\xc0|\x89\xf4\xb8\xce\xad\x85\xba\x1f\xe1\xc9\xe3M\x19\xc3P\x02\xa1\x1a1\xa2\x11:\x87\x98\xee\xdc'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x03\x0f\x1b\x88\x86\x9c~\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'P\x02\xa1\x1a1\xa2\x11:\x87\x98\xee\xdc'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"mkd\nd6d1ffe5d2df308a5212a3c8e93e0eb6be36c94dc19a2647e45d9129dd30772a\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:mkd
d6d1ffe5d2df308a5212a3c8e93e0eb6be36c94dc19a2647e45d9129dd30772a
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:command_format
DEBUG:__main__:del
test1
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:del
test1
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x04\xc5Or\xed\xe1\xe9\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x10=\x84\xbe=^$p\xf3'
MAC: b'\nJ\x96\x83\xafF\x90\x17\x95\xfe\xc8\xfc'nonce b'\x00\x04\xc5Or\xed\xe1\xe9'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00%\x00\x04\xc5Or\xed\xe1\xe9\x00\x00\x10=\x84\xbe=^$p\xf3\nJ\x96\x83\xafF\x90\x17\x95\xfe\xc8\xfc'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 9cfdfe42b438391e8ca81609d45175424f00bb7dd36171ab05e984a20a2b06c2
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b'\x01\x00\x01\x00\x00%\x00\x04\xc5Or\xed\xe1\xe9\x00\x00\x10=\x84\xbe=^$p\xf3\nJ\x96\x83\xafF\x90\x17\x95\xfe\xc8\xfc'
Message hash: b'\x9c\xfd\xfeB\xb489\x1e\x8c\xa8\x16\t\xd4QuBO\x00\xbb}\xd3aq\xab\x05\xe9\x84\xa2\n+\x06\xc2'

DEBUG:__main__:b'\x01\x00\x01\x00\x00%\x00\x04\xc5Or\xed\xe1\xe9\x00\x00\x10=\x84\xbe=^$p\xf3\nJ\x96\x83\xafF\x90\x17\x95\xfe\xc8\xfc'
DEBUG:__main__:b'\x9c\xfd\xfeB\xb489\x1e\x8c\xa8\x16\t\xd4QuBO\x00\xbb}\xd3aq\xab\x05\xe9\x84\xa2\n+\x06\xc2'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x04\x0f\x1b\x88\x86\x9c~\x00\x00\x1bu\t\x9b\xdc\xfd\xc4A\x15\x05\xe4\xae9%zt?\xc9\x10a\xf2\xecDWI\xe0{\xc8j\xc4\xdd\xec\xadV\xdf\x80\xfd\xfaJAP\xa0\xba\xce\x18\x1e8\xbav\x8b\x1e\x94\xa2\xfb\x89|\x91U\xb9\x85\xd8N\x02\xc1>c/\x95\xb9K\x142"M\xe9\xa4\xb97I\x11t"\x0fC\xa7X\xad[\x86qA\xf9\x8e\x17\x9a<_f!`f\x11\xcd\x05\xa6\xcb \xde\x0c\xc9\xdf\xce\'\xcfI\x04\xd0lb[a\x192p\xad}\x0e\xc2\xcbM'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x04\x0f\x1b\x88\x86\x9c~\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'b[a\x192p\xad}\x0e\xc2\xcbM'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"del\n9cfdfe42b438391e8ca81609d45175424f00bb7dd36171ab05e984a20a2b06c2\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:del
9cfdfe42b438391e8ca81609d45175424f00bb7dd36171ab05e984a20a2b06c2
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:command_format
DEBUG:__main__:chd
test5
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
test5
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x05\xe4H\x10\xe7~\x1f\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b"X\xc8\xa4y8\xdcD'6"
MAC: b'Zd\x05\x18p!\x82\xb5P\xc2\xb6<'nonce b'\x00\x05\xe4H\x10\xe7~\x1f'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b"\x01\x00\x01\x00\x00%\x00\x05\xe4H\x10\xe7~\x1f\x00\x00X\xc8\xa4y8\xdcD'6Zd\x05\x18p!\x82\xb5P\xc2\xb6<"
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: d2596b9402248c2f2857c7641a3b873b10a5abe25703f66f832403416be46416
DEBUG:__main__:SQN: b'\x00\x05'
Request message: b"\x01\x00\x01\x00\x00%\x00\x05\xe4H\x10\xe7~\x1f\x00\x00X\xc8\xa4y8\xdcD'6Zd\x05\x18p!\x82\xb5P\xc2\xb6<"
Message hash: b'\xd2Yk\x94\x02$\x8c/(W\xc7d\x1a;\x87;\x10\xa5\xab\xe2W\x03\xf6o\x83$\x03Ak\xe4d\x16'

DEBUG:__main__:b"\x01\x00\x01\x00\x00%\x00\x05\xe4H\x10\xe7~\x1f\x00\x00X\xc8\xa4y8\xdcD'6Zd\x05\x18p!\x82\xb5P\xc2\xb6<"
DEBUG:__main__:b'\xd2Yk\x94\x02$\x8c/(W\xc7d\x1a;\x87;\x10\xa5\xab\xe2W\x03\xf6o\x83$\x03Ak\xe4d\x16'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x05\x0f\x1b\x88\x86\x9c~\x00\x00\xfa\xea\x1e\x1d\x9f\xcd\xadF,\xff\xec5E\xed\xdc\xb0u\xab\xd6\r\x04+\xf9\x9a\x19\n \xa6\x15\xb6\x11g\xfe/\xdd\xb4\x95kvL\xe2uQ\xf8tu\x1a0\xe8=\xf83>DS\xa9h-G9i\x0e\xfd\x05RV\xadS|\xcfhi\n\xa4\x0f\xc6\xbe)sLj\x7f\x8d[O+H\x1c\xab>\xc0r\xa3\x9b\x85:\xb9^R_\xc8~7m\xb6\xb0\xe8\xc4[\xd2\xcb\xe7\xce\x7f\xb3\x9a\xc8p\x0c\xb3\x7f\x8d\x18\xe6av\xcaV\x86\x80'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x05\x0f\x1b\x88\x86\x9c~\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x0c\xb3\x7f\x8d\x18\xe6av\xcaV\x86\x80'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"chd\nd2596b9402248c2f2857c7641a3b873b10a5abe25703f66f832403416be46416\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:chd
d2596b9402248c2f2857c7641a3b873b10a5abe25703f66f832403416be46416
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:command_format
DEBUG:__main__:chd
rd
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\x95\xfb\xd5`\x90Go[xTq1\xd8^\xd5\x9c\x08\xba\x9d\x1c\xd5d\xba\x84OU\xc1$22\xf6\xd6'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00"'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
rd
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00"\x00\x06\xd1\xa1\xb5\xfd\xe4\x12\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x18\xe8\x18\xfdBl'
MAC: b'*Yk\x06\xe9\xbc\xf4xXR\xc4\xb0'nonce b'\x00\x06\xd1\xa1\xb5\xfd\xe4\x12'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00"\x00\x06\xd1\xa1\xb5\xfd\xe4\x12\x00\x00\x18\xe8\x18\xfdBl*Yk\x06\xe9\xbc\xf4xXR\xc4\xb0'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 7b32982807c3f4891843108186433ac44fa0583bf49911c4308cebd3550c82fa
DEBUG:__main__:SQN: b'\x00\x06'
Request message: b'\x01\x00\x01\x00\x00"\x00\x06\xd1\xa1\xb5\xfd\xe4\x12\x00\x00\x18\xe8\x18\xfdBl*Yk\x06\xe9\xbc\xf4xXR\xc4\xb0'
Message hash: b'{2\x98(\x07\xc3\xf4\x89\x18C\x10\x81\x86C:\xc4O\xa0X;\xf4\x99\x11\xc40\x8c\xeb\xd3U\x0c\x82\xfa'

DEBUG:__main__:b'\x01\x00\x01\x00\x00"\x00\x06\xd1\xa1\xb5\xfd\xe4\x12\x00\x00\x18\xe8\x18\xfdBl*Yk\x06\xe9\xbc\xf4xXR\xc4\xb0'
DEBUG:__main__:b'{2\x98(\x07\xc3\xf4\x89\x18C\x10\x81\x86C:\xc4O\xa0X;\xf4\x99\x11\xc40\x8c\xeb\xd3U\x0c\x82\xfa'
ERROR:__main__:Problem with sending the message: [WinError 10054] An existing connection was forcibly closed by the remote host
ERROR:__main__:An error was occurred during the process: [WinError 10054] An existing connection was forcibly closed by the remote host
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134692430868900
alice
aaa
83af2debb96533b3470df5f834df544c
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134692430868900
alice
aaa
83af2debb96533b3470df5f834df544c
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01Y\x8d\x13Y\xd4k\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x82\x81P\x8e\xfcY\x15)!o\xa8\xd8'nonce b'\x00\x01Y\x8d\x13Y\xd4k'
tk: b';\xec\x8c\xfdK\xaa\x80N\xe0\xb1S\x8c\xef\xe2\xe3\xb5\xd9\xc0S\xacv\x1d5KQ\x8d\x02/\xc2\xe8\x84r'
encrypted payload: b'\xa6 [7-K\xb29\x870#:s\x17\r\xb1\xa9\xd7$\xe8@T\xac\xd38\x1fU\xf4V9\xa2\xa9"\xe4\xf3\xc8\x9e\xa6K\xe9-\x93\xfb\xdd\xf4t\xf1sM*d\xe7\xca\xac\xa4\xdc$\x9c\xd28\xdc$'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'\x02\xa2H\xed\xefZ\xef\x05\xf5\x87R\x90\xbf\xadw\x07\xce]\xce\x97\xcf\x116<3\xc9\xbd{w\xe2\xdf&\x03\xca>hC=\x81\x13\xd4\x16/\xf2\x03?j\x88GU\xe4\xa4r\xe7n\x18\xf4\xfdJ\x91\xe7/\x82\x82%\x9dk\x8c\xc9B\x06$+\xa8\xd5\xeb4\x11\x17\x87\x18C\xb8\x011t\xc2$\xb2T\xd7\x9a\x01\xa0xH\x14W\xc1\xec\xb7SH\xbf<<1W~\xe3\x85\x817^t\xe7:-\x03\x0f\x00\xe5\xc8H\xf5\xec\xa2\x92K\x8f\xf5\xdb\t\xfdt\xc8\x19\xd2\x17\xabkt\x08\x17\x9b\xa9a\xdf0e\xfc\x9d\xd7[\xff\x12\xfd\xa1\x0f\xe6\x0b\x89\x81ukV8\xb7\xe3L\xe2\x95\r\xd1\x8enm\x7fy_\xf5\xdc\xdc\xa6\xfff\x9b\xbcx"\x8f/\x1a#\x07\xbc\xe4\xa1F\xd9\xa6T\xe8\xd99\xbe\xcf\xdc\x06 \xb4\xdc;\xd8\x02\xf3\n\x9b\xcc@\xf1\x98D*{\x97 S\xb1ZaS\xae\x10H\xfc7a\xa2`\xabv\xfd\x90F4\x81=-\x88\xfbC\x95\xd6W\x1f'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01Y\x8d\x13Y\xd4k\x00\x00\xa6 [7-K\xb29\x870#:s\x17\r\xb1\xa9\xd7$\xe8@T\xac\xd38\x1fU\xf4V9\xa2\xa9"\xe4\xf3\xc8\x9e\xa6K\xe9-\x93\xfb\xdd\xf4t\xf1sM*d\xe7\xca\xac\xa4\xdc$\x9c\xd28\xdc$\x82\x81P\x8e\xfcY\x15)!o\xa8\xd8\x02\xa2H\xed\xefZ\xef\x05\xf5\x87R\x90\xbf\xadw\x07\xce]\xce\x97\xcf\x116<3\xc9\xbd{w\xe2\xdf&\x03\xca>hC=\x81\x13\xd4\x16/\xf2\x03?j\x88GU\xe4\xa4r\xe7n\x18\xf4\xfdJ\x91\xe7/\x82\x82%\x9dk\x8c\xc9B\x06$+\xa8\xd5\xeb4\x11\x17\x87\x18C\xb8\x011t\xc2$\xb2T\xd7\x9a\x01\xa0xH\x14W\xc1\xec\xb7SH\xbf<<1W~\xe3\x85\x817^t\xe7:-\x03\x0f\x00\xe5\xc8H\xf5\xec\xa2\x92K\x8f\xf5\xdb\t\xfdt\xc8\x19\xd2\x17\xabkt\x08\x17\x9b\xa9a\xdf0e\xfc\x9d\xd7[\xff\x12\xfd\xa1\x0f\xe6\x0b\x89\x81ukV8\xb7\xe3L\xe2\x95\r\xd1\x8enm\x7fy_\xf5\xdc\xdc\xa6\xfff\x9b\xbcx"\x8f/\x1a#\x07\xbc\xe4\xa1F\xd9\xa6T\xe8\xd99\xbe\xcf\xdc\x06 \xb4\xdc;\xd8\x02\xf3\n\x9b\xcc@\xf1\x98D*{\x97 S\xb1ZaS\xae\x10H\xfc7a\xa2`\xabv\xfd\x90F4\x81=-\x88\xfbC\x95\xd6W\x1f'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01Y\x8d\x13Y\xd4k\x00\x00\xa6 [7-K\xb29\x870#:s\x17\r\xb1\xa9\xd7$\xe8@T\xac\xd38\x1fU\xf4V9\xa2\xa9"\xe4\xf3\xc8\x9e\xa6K\xe9-\x93\xfb\xdd\xf4t\xf1sM*d\xe7\xca\xac\xa4\xdc$\x9c\xd28\xdc$\x82\x81P\x8e\xfcY\x15)!o\xa8\xd8\x02\xa2H\xed\xefZ\xef\x05\xf5\x87R\x90\xbf\xadw\x07\xce]\xce\x97\xcf\x116<3\xc9\xbd{w\xe2\xdf&\x03\xca>hC=\x81\x13\xd4\x16/\xf2\x03?j\x88GU\xe4\xa4r\xe7n\x18\xf4\xfdJ\x91\xe7/\x82\x82%\x9dk\x8c\xc9B\x06$+\xa8\xd5\xeb4\x11\x17\x87\x18C\xb8\x011t\xc2$\xb2T\xd7\x9a\x01\xa0xH\x14W\xc1\xec\xb7SH\xbf<<1W~\xe3\x85\x817^t\xe7:-\x03\x0f\x00\xe5\xc8H\xf5\xec\xa2\x92K\x8f\xf5\xdb\t\xfdt\xc8\x19\xd2\x17\xabkt\x08\x17\x9b\xa9a\xdf0e\xfc\x9d\xd7[\xff\x12\xfd\xa1\x0f\xe6\x0b\x89\x81ukV8\xb7\xe3L\xe2\x95\r\xd1\x8enm\x7fy_\xf5\xdc\xdc\xa6\xfff\x9b\xbcx"\x8f/\x1a#\x07\xbc\xe4\xa1F\xd9\xa6T\xe8\xd99\xbe\xcf\xdc\x06 \xb4\xdc;\xd8\x02\xf3\n\x9b\xcc@\xf1\x98D*{\x97 S\xb1ZaS\xae\x10H\xfc7a\xa2`\xabv\xfd\x90F4\x81=-\x88\xfbC\x95\xd6W\x1f'
DEBUG:SiFT_MTP:TK from MTP: b';\xec\x8c\xfdK\xaa\x80N\xe0\xb1S\x8c\xef\xe2\xe3\xb5\xd9\xc0S\xacv\x1d5KQ\x8d\x02/\xc2\xe8\x84r'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 9aa17670100e829d7050b0fcee11c97dd642c6a827faf1bce431e69adc306ae6
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01Y\x8d\x13Y\xd4k\x00\x00\xa6 [7-K\xb29\x870#:s\x17\r\xb1\xa9\xd7$\xe8@T\xac\xd38\x1fU\xf4V9\xa2\xa9"\xe4\xf3\xc8\x9e\xa6K\xe9-\x93\xfb\xdd\xf4t\xf1sM*d\xe7\xca\xac\xa4\xdc$\x9c\xd28\xdc$\x82\x81P\x8e\xfcY\x15)!o\xa8\xd8\x02\xa2H\xed\xefZ\xef\x05\xf5\x87R\x90\xbf\xadw\x07\xce]\xce\x97\xcf\x116<3\xc9\xbd{w\xe2\xdf&\x03\xca>hC=\x81\x13\xd4\x16/\xf2\x03?j\x88GU\xe4\xa4r\xe7n\x18\xf4\xfdJ\x91\xe7/\x82\x82%\x9dk\x8c\xc9B\x06$+\xa8\xd5\xeb4\x11\x17\x87\x18C\xb8\x011t\xc2$\xb2T\xd7\x9a\x01\xa0xH\x14W\xc1\xec\xb7SH\xbf<<1W~\xe3\x85\x817^t\xe7:-\x03\x0f\x00\xe5\xc8H\xf5\xec\xa2\x92K\x8f\xf5\xdb\t\xfdt\xc8\x19\xd2\x17\xabkt\x08\x17\x9b\xa9a\xdf0e\xfc\x9d\xd7[\xff\x12\xfd\xa1\x0f\xe6\x0b\x89\x81ukV8\xb7\xe3L\xe2\x95\r\xd1\x8enm\x7fy_\xf5\xdc\xdc\xa6\xfff\x9b\xbcx"\x8f/\x1a#\x07\xbc\xe4\xa1F\xd9\xa6T\xe8\xd99\xbe\xcf\xdc\x06 \xb4\xdc;\xd8\x02\xf3\n\x9b\xcc@\xf1\x98D*{\x97 S\xb1ZaS\xae\x10H\xfc7a\xa2`\xabv\xfd\x90F4\x81=-\x88\xfbC\x95\xd6W\x1f'
Message hash: b"\x9a\xa1vp\x10\x0e\x82\x9dpP\xb0\xfc\xee\x11\xc9}\xd6B\xc6\xa8'\xfa\xf1\xbc\xe41\xe6\x9a\xdc0j\xe6"
My random: 83af2debb96533b3470df5f834df544c
Temp key: b';\xec\x8c\xfdK\xaa\x80N\xe0\xb1S\x8c\xef\xe2\xe3\xb5\xd9\xc0S\xacv\x1d5KQ\x8d\x02/\xc2\xe8\x84r'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b'\x01\x00\x00\x10\x00}\x00\x01C-\xfc\xfa\xa6\xa3\x00\x00\xeb\xa2\xdcsW\xd8W\xc2\xd5b&\xb4\xb7_\x0c\xe1C\x16\xa4@\x86{z\x8fg\x8a\xff^\x1c\x19c8@\x94Hl8\x8f\xa1L\xb97\x920\xb7\xfa\xd1\xa5ki%n\xdc\xc7\xf0\xd9\xa0\x1f\xbd.\x88\xf4>\xc1\x95w\xb5D\x96\xf9b\x08\xfba\xfb\x8a\xb3RF>\xc5o\xbb\xb9\xd3\xeeQ8q\xb6\xd0\xa3\x8b\xb2X,\xaa\x1f\xfd&\xb7\x91FM\xd6\xd1\x82\xfe\x7f'
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b'\x01\x00\x00\x10\x00}\x00\x01C-\xfc\xfa\xa6\xa3\x00\x00\xeb\xa2\xdcsW\xd8W\xc2\xd5b&\xb4\xb7_\x0c\xe1C\x16\xa4@\x86{z\x8fg\x8a\xff^\x1c\x19c8@\x94Hl8\x8f\xa1L\xb97\x920\xb7\xfa\xd1\xa5ki%n\xdc\xc7\xf0\xd9\xa0\x1f\xbd.\x88\xf4>\xc1\x95w\xb5D\x96\xf9b\x08\xfba\xfb\x8a\xb3RF>\xc5o\xbb\xb9\xd3\xeeQ8q\xb6\xd0\xa3\x8b\xb2X,\xaa\x1f\xfd&\xb7\x91FM\xd6\xd1\x82\xfe\x7f'
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01C-\xfc\xfa\xa6\xa3\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x1f\xfd&\xb7\x91FM\xd6\xd1\x82\xfe\x7f'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'9aa17670100e829d7050b0fcee11c97dd642c6a827faf1bce431e69adc306ae6\ncfba1bc8b195eaef41a0b8aa67cef3dd'
DEBUG:SiFT_MTP:9aa17670100e829d7050b0fcee11c97dd642c6a827faf1bce431e69adc306ae6
cfba1bc8b195eaef41a0b8aa67cef3dd
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'?\x17\x87A\xef \xc70us\x1c\xc0\x8c\xda\xad\xe7\xf6t|\xf45\ntm\x85\x94\x10\xa7O\xd4\x12['
INFO:__main__:END OF LOGIN
DEBUG:__main__:['mkd', 'test7']
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test7
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'?\x17\x87A\xef \xc70us\x1c\xc0\x8c\xda\xad\xe7\xf6t|\xf45\ntm\x85\x94\x10\xa7O\xd4\x12['
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00%'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test7
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00%\x00\x02B\xe6u\x85\xf7y\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x9c\xf3\x9b\xba\xab\xab\x16\xd2G'
MAC: b'c\xf1\x93\xafd\x95\x89\x83\xbe\xdb\xed\xd8'nonce b'\x00\x02B\xe6u\x85\xf7y'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00%\x00\x02B\xe6u\x85\xf7y\x00\x00\x9c\xf3\x9b\xba\xab\xab\x16\xd2Gc\xf1\x93\xafd\x95\x89\x83\xbe\xdb\xed\xd8'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 99b91cb531f3757278322522aea48999937604a3e22983c1a00389760b861077
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00%\x00\x02B\xe6u\x85\xf7y\x00\x00\x9c\xf3\x9b\xba\xab\xab\x16\xd2Gc\xf1\x93\xafd\x95\x89\x83\xbe\xdb\xed\xd8'
Message hash: b'\x99\xb9\x1c\xb51\xf3urx2%"\xae\xa4\x89\x99\x93v\x04\xa3\xe2)\x83\xc1\xa0\x03\x89v\x0b\x86\x10w'

DEBUG:__main__:b'\x01\x00\x01\x00\x00%\x00\x02B\xe6u\x85\xf7y\x00\x00\x9c\xf3\x9b\xba\xab\xab\x16\xd2Gc\xf1\x93\xafd\x95\x89\x83\xbe\xdb\xed\xd8'
DEBUG:__main__:b'\x99\xb9\x1c\xb51\xf3urx2%"\xae\xa4\x89\x99\x93v\x04\xa3\xe2)\x83\xc1\xa0\x03\x89v\x0b\x86\x10w'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x92\x00\x02\xc4p\x1dZ\xa2x\x00\x00\xc6\x91\xb4\xda\xa3\x1c\x96\xaf\xf5\xec\xf2H\xb2/Um\x06\x1ai\xb9\x16\x00\xcc\xfe\xb8\x91N\xfc)V\xf5\xd8i\xc9@\xe7\x91\xd2nfyW\x84>\xd6\xac\xd5.\xa5\xb3~|&\x06\xf3\xc2M\xba{M\x87$p\xee\xb0:\x9f\xfcX\xb9\xe1Bc\xce4\xe9F\x9f~\x9e\x17\xc2z)\xf12F\xe1\t\x9a"\x06\xf6\x9a(_\xac\xab\xe9M\xdf\xb7>\xf1\xad\xf7\xfb\nu\x83\xa1\x00Iv\xd5\x07aM\xe1\x04\xa4\xfb}\xc2\x13t\xba+\x94\xa8'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x92\x00\x02\xc4p\x1dZ\xa2x\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xe1\x04\xa4\xfb}\xc2\x13t\xba+\x94\xa8'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"mkd\n99b91cb531f3757278322522aea48999937604a3e22983c1a00389760b861077\nfailure\nobject of type 'WindowsPath' has no len()"
DEBUG:SiFT_MTP:mkd
99b91cb531f3757278322522aea48999937604a3e22983c1a00389760b861077
failure
object of type 'WindowsPath' has no len()
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652134794022274700
alice
aaa
eadbf655cd1e6a8c89a31b42582729db
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652134794022274700
alice
aaa
eadbf655cd1e6a8c89a31b42582729db
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01$\xed\tp<\xfc\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b'\x12\xf9%R\xccZ\xfd\xb8 \xa7\xfd\x86'nonce b'\x00\x01$\xed\tp<\xfc'
tk: b'N$\xd4/\x90Y\x9f;Am\xe1\x0b"\xdc[T4\xde\x8b\xa9\xb5\xfe\x00o\xd7\x83w0\xeeh\xcb\xf4'
encrypted payload: b'\xca\x02\x9d2g\xb984\xbd\x8c\x07\xb3\xf91\x96\x8c\xe5dg\xee\xe1\xf5\x19(Y\x0b\xc75\xee\xe0\xe7\x13\x12\x16\x0f\xd6\xfd\x14\x1c\x87\xa8\x1b)\x92\xb8\x9a*V\x0bp\x03\xd2\x1a\x83-\x17&B\x82\xf0\xd0\x15'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b'f/\\\x15p c\x9f\x9d"\x00\xa45`\x04|0\xae^\x87\ni\xbaa\xdf0Fn\x9eG\xf3\xac\xd2b\xfe\x871 \x00KnO\xe9\x9e\tJs\xd9\xda\xee{\xa6\xea\xf8\xc2\xcd\x12P\n\xb2\xc56\x1dO\x83\x85\xa2D\x94\xa5\xa5s\xbap\xb1C\x05\xa6\xb2\xe6\xbf\x05\xd1\x16\xbd\xf2y\x14\xb2}\xbei\xa2\xffG-\xf98\xb0g|\xa7t\xcf\xe5\xe8\x84\x8d\xfbW9\x1b\x99\xa4\xec\xf5\x9fP\xda-`\xfeQZd`\xc3\x00j\x85\xbc\x98\xc5\xd7\x10-\xc4\xfb\xabghSC\xa9\xfb\x97a+,\x12;\x90<_\xd7A\xac.(T\x855\x84T\xcb\x99q-\xe49Q\x87\xe1\x0c\xcbG\xa6\x8f.\xdb\xc4?\xca\xa2\xcb\x7f\x18\xd2t0\x86x0+j)\xb4[N\x18\xc7\xfb\xf8\x89J\x10\xb9[\xfb\x9cF\xa4\nJ\xec\x18b\xc8\r|I\xc3\xd7b\x0f\x99\x87\x02aX\xce\x0c\xd8\xe0\x02\xd3\x85\x99\x1a\xa4\xb6\xe9\xd9\xfb\xd2\x9bm0!*\xbd\xe9\xf2\xd1\xda\x8c'
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b'\x01\x00\x00\x00\x01Z\x00\x01$\xed\tp<\xfc\x00\x00\xca\x02\x9d2g\xb984\xbd\x8c\x07\xb3\xf91\x96\x8c\xe5dg\xee\xe1\xf5\x19(Y\x0b\xc75\xee\xe0\xe7\x13\x12\x16\x0f\xd6\xfd\x14\x1c\x87\xa8\x1b)\x92\xb8\x9a*V\x0bp\x03\xd2\x1a\x83-\x17&B\x82\xf0\xd0\x15\x12\xf9%R\xccZ\xfd\xb8 \xa7\xfd\x86f/\\\x15p c\x9f\x9d"\x00\xa45`\x04|0\xae^\x87\ni\xbaa\xdf0Fn\x9eG\xf3\xac\xd2b\xfe\x871 \x00KnO\xe9\x9e\tJs\xd9\xda\xee{\xa6\xea\xf8\xc2\xcd\x12P\n\xb2\xc56\x1dO\x83\x85\xa2D\x94\xa5\xa5s\xbap\xb1C\x05\xa6\xb2\xe6\xbf\x05\xd1\x16\xbd\xf2y\x14\xb2}\xbei\xa2\xffG-\xf98\xb0g|\xa7t\xcf\xe5\xe8\x84\x8d\xfbW9\x1b\x99\xa4\xec\xf5\x9fP\xda-`\xfeQZd`\xc3\x00j\x85\xbc\x98\xc5\xd7\x10-\xc4\xfb\xabghSC\xa9\xfb\x97a+,\x12;\x90<_\xd7A\xac.(T\x855\x84T\xcb\x99q-\xe49Q\x87\xe1\x0c\xcbG\xa6\x8f.\xdb\xc4?\xca\xa2\xcb\x7f\x18\xd2t0\x86x0+j)\xb4[N\x18\xc7\xfb\xf8\x89J\x10\xb9[\xfb\x9cF\xa4\nJ\xec\x18b\xc8\r|I\xc3\xd7b\x0f\x99\x87\x02aX\xce\x0c\xd8\xe0\x02\xd3\x85\x99\x1a\xa4\xb6\xe9\xd9\xfb\xd2\x9bm0!*\xbd\xe9\xf2\xd1\xda\x8c'
DEBUG:SiFT_MTP:Message from MTP: b'\x01\x00\x00\x00\x01Z\x00\x01$\xed\tp<\xfc\x00\x00\xca\x02\x9d2g\xb984\xbd\x8c\x07\xb3\xf91\x96\x8c\xe5dg\xee\xe1\xf5\x19(Y\x0b\xc75\xee\xe0\xe7\x13\x12\x16\x0f\xd6\xfd\x14\x1c\x87\xa8\x1b)\x92\xb8\x9a*V\x0bp\x03\xd2\x1a\x83-\x17&B\x82\xf0\xd0\x15\x12\xf9%R\xccZ\xfd\xb8 \xa7\xfd\x86f/\\\x15p c\x9f\x9d"\x00\xa45`\x04|0\xae^\x87\ni\xbaa\xdf0Fn\x9eG\xf3\xac\xd2b\xfe\x871 \x00KnO\xe9\x9e\tJs\xd9\xda\xee{\xa6\xea\xf8\xc2\xcd\x12P\n\xb2\xc56\x1dO\x83\x85\xa2D\x94\xa5\xa5s\xbap\xb1C\x05\xa6\xb2\xe6\xbf\x05\xd1\x16\xbd\xf2y\x14\xb2}\xbei\xa2\xffG-\xf98\xb0g|\xa7t\xcf\xe5\xe8\x84\x8d\xfbW9\x1b\x99\xa4\xec\xf5\x9fP\xda-`\xfeQZd`\xc3\x00j\x85\xbc\x98\xc5\xd7\x10-\xc4\xfb\xabghSC\xa9\xfb\x97a+,\x12;\x90<_\xd7A\xac.(T\x855\x84T\xcb\x99q-\xe49Q\x87\xe1\x0c\xcbG\xa6\x8f.\xdb\xc4?\xca\xa2\xcb\x7f\x18\xd2t0\x86x0+j)\xb4[N\x18\xc7\xfb\xf8\x89J\x10\xb9[\xfb\x9cF\xa4\nJ\xec\x18b\xc8\r|I\xc3\xd7b\x0f\x99\x87\x02aX\xce\x0c\xd8\xe0\x02\xd3\x85\x99\x1a\xa4\xb6\xe9\xd9\xfb\xd2\x9bm0!*\xbd\xe9\xf2\xd1\xda\x8c'
DEBUG:SiFT_MTP:TK from MTP: b'N$\xd4/\x90Y\x9f;Am\xe1\x0b"\xdc[T4\xde\x8b\xa9\xb5\xfe\x00o\xd7\x83w0\xeeh\xcb\xf4'
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 537caacd4b37d1be4b7d21c484f62fe8c29e816f27fe0faa68719988d3ffb7d8
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b'\x01\x00\x00\x00\x01Z\x00\x01$\xed\tp<\xfc\x00\x00\xca\x02\x9d2g\xb984\xbd\x8c\x07\xb3\xf91\x96\x8c\xe5dg\xee\xe1\xf5\x19(Y\x0b\xc75\xee\xe0\xe7\x13\x12\x16\x0f\xd6\xfd\x14\x1c\x87\xa8\x1b)\x92\xb8\x9a*V\x0bp\x03\xd2\x1a\x83-\x17&B\x82\xf0\xd0\x15\x12\xf9%R\xccZ\xfd\xb8 \xa7\xfd\x86f/\\\x15p c\x9f\x9d"\x00\xa45`\x04|0\xae^\x87\ni\xbaa\xdf0Fn\x9eG\xf3\xac\xd2b\xfe\x871 \x00KnO\xe9\x9e\tJs\xd9\xda\xee{\xa6\xea\xf8\xc2\xcd\x12P\n\xb2\xc56\x1dO\x83\x85\xa2D\x94\xa5\xa5s\xbap\xb1C\x05\xa6\xb2\xe6\xbf\x05\xd1\x16\xbd\xf2y\x14\xb2}\xbei\xa2\xffG-\xf98\xb0g|\xa7t\xcf\xe5\xe8\x84\x8d\xfbW9\x1b\x99\xa4\xec\xf5\x9fP\xda-`\xfeQZd`\xc3\x00j\x85\xbc\x98\xc5\xd7\x10-\xc4\xfb\xabghSC\xa9\xfb\x97a+,\x12;\x90<_\xd7A\xac.(T\x855\x84T\xcb\x99q-\xe49Q\x87\xe1\x0c\xcbG\xa6\x8f.\xdb\xc4?\xca\xa2\xcb\x7f\x18\xd2t0\x86x0+j)\xb4[N\x18\xc7\xfb\xf8\x89J\x10\xb9[\xfb\x9cF\xa4\nJ\xec\x18b\xc8\r|I\xc3\xd7b\x0f\x99\x87\x02aX\xce\x0c\xd8\xe0\x02\xd3\x85\x99\x1a\xa4\xb6\xe9\xd9\xfb\xd2\x9bm0!*\xbd\xe9\xf2\xd1\xda\x8c'
Message hash: b"S|\xaa\xcdK7\xd1\xbeK}!\xc4\x84\xf6/\xe8\xc2\x9e\x81o'\xfe\x0f\xaahq\x99\x88\xd3\xff\xb7\xd8"
My random: eadbf655cd1e6a8c89a31b42582729db
Temp key: b'N$\xd4/\x90Y\x9f;Am\xe1\x0b"\xdc[T4\xde\x8b\xa9\xb5\xfe\x00o\xd7\x83w0\xeeh\xcb\xf4'
INFO:__main__:Message sent
DEBUG:__main__:Login response: b"\x01\x00\x00\x10\x00}\x00\x01\xa8\x13\xa4+3\x16\x00\x00\xac\x87\xa0\x83\xbfCL\xf7\xfbj\x0b\xec\x9e\tz\xd0\xffB\xeb%\xb8\xe2\x91-<7'R!5\x0e\x02\xc2'\xf1\xd4\x8b'it\xc6M\xc6\x16\x05\xd9\x83\xa0\x1b\xfdb\xd8\xb7W\xba\xf0\xf5`\xb2\x8f\xb4\x04\xec\x04\x9f+[fD\xf1\x1dY\xdd\xc1\x1cd\x13{9\xcel\xc7\xd6\xe5jy\x952\xf8\xa6\x8f\x80S\x0f(i\x7f\xf9M\x94Wd3\t\x11\x9e8\r\r"
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b"\x01\x00\x00\x10\x00}\x00\x01\xa8\x13\xa4+3\x16\x00\x00\xac\x87\xa0\x83\xbfCL\xf7\xfbj\x0b\xec\x9e\tz\xd0\xffB\xeb%\xb8\xe2\x91-<7'R!5\x0e\x02\xc2'\xf1\xd4\x8b'it\xc6M\xc6\x16\x05\xd9\x83\xa0\x1b\xfdb\xd8\xb7W\xba\xf0\xf5`\xb2\x8f\xb4\x04\xec\x04\x9f+[fD\xf1\x1dY\xdd\xc1\x1cd\x13{9\xcel\xc7\xd6\xe5jy\x952\xf8\xa6\x8f\x80S\x0f(i\x7f\xf9M\x94Wd3\t\x11\x9e8\r\r"
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x10\x00}\x00\x01\xa8\x13\xa4+3\x16\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xf9M\x94Wd3\t\x11\x9e8\r\r'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'537caacd4b37d1be4b7d21c484f62fe8c29e816f27fe0faa68719988d3ffb7d8\n9b830d0a5ecf4b6830a2a7f6b54c7f8f'
DEBUG:SiFT_MTP:537caacd4b37d1be4b7d21c484f62fe8c29e816f27fe0faa68719988d3ffb7d8
9b830d0a5ecf4b6830a2a7f6b54c7f8f
DEBUG:__main__:generate_final_key
DEBUG:__main__:FINAL KEY: b'\xf7T\xfd\x8f\x0bC\x8a\x93g\\\x83-\xd2\x0e\x0b}\xfa_L\x89\x8a\x0fq\xf6{ZZ\xcc\x83\x9cf\xd1'
INFO:__main__:END OF LOGIN
DEBUG:__main__:['mkd', 'test']
DEBUG:__main__:command_format
DEBUG:__main__:mkd
test
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf7T\xfd\x8f\x0bC\x8a\x93g\\\x83-\xd2\x0e\x0b}\xfa_L\x89\x8a\x0fq\xf6{ZZ\xcc\x83\x9cf\xd1'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00$'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:mkd
test
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00$\x00\x02\x1e\x15$\x9bu\xce\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'Zr\xb0?\xb9\xcbG\xad'
MAC: b'"\xd5k\x92\xd0R`\xc4\xd0\xac\xd6O'nonce b'\x00\x02\x1e\x15$\x9bu\xce'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00$\x00\x02\x1e\x15$\x9bu\xce\x00\x00Zr\xb0?\xb9\xcbG\xad"\xd5k\x92\xd0R`\xc4\xd0\xac\xd6O'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
DEBUG:__main__:SQN: b'\x00\x02'
Request message: b'\x01\x00\x01\x00\x00$\x00\x02\x1e\x15$\x9bu\xce\x00\x00Zr\xb0?\xb9\xcbG\xad"\xd5k\x92\xd0R`\xc4\xd0\xac\xd6O'
Message hash: b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'

DEBUG:__main__:b'\x01\x00\x01\x00\x00$\x00\x02\x1e\x15$\x9bu\xce\x00\x00Zr\xb0?\xb9\xcbG\xad"\xd5k\x92\xd0R`\xc4\xd0\xac\xd6O'
DEBUG:__main__:b'\x8bc\x18:\xfdrG\x9c\x95\x1f\xc3HY\\~\x90L\xc3\xc7+\xa3Y\xe5\x94c\xdc\x94F\xc7xs\xcf'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b"\x01\x00\x01\x10\x00h\x00\x02\xb9\x13\xc2T\x19q\x00\x00+u'1j\x1a\x00\xcf\xff\xdb\x14t\xe8\x9e?m\xebp\xa6%C1Z\x81\xae\xcce\xc6-7\xe3\x14\x99^\xc18\xa0\x8b\x0e\xe1$_\xb7\xf2;a,\x07\x80U\xac\xa2\x8a\xa0\x1b\xdf\xdc \xa9D\xcf`{\x93M\xceH\xac\x89\x7f\xe7\xbb\xf5\x1b\xbb\xdfnP\xd8L\x887g\x91#\\\xe3~"
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00h\x00\x02\xb9\x13\xc2T\x19q\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'nP\xd8L\x887g\x91#\\\xe3~'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'mkd\n8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf\nsuccess'
DEBUG:SiFT_MTP:mkd
8b63183afd72479c951fc348595c7e904cc3c72ba359e59463dc9446c77873cf
success
DEBUG:__main__:command_format
DEBUG:__main__:lst
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf7T\xfd\x8f\x0bC\x8a\x93g\\\x83-\xd2\x0e\x0b}\xfa_L\x89\x8a\x0fq\xf6{ZZ\xcc\x83\x9cf\xd1'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00\x1f'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:lst
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00\x1f\x00\x03^\xd6v\x8a\xe7\xee\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\x07"i'
MAC: b'\x91\xa4>\xd4Hw`!O\x94`\xb0'nonce b'\x00\x03^\xd6v\x8a\xe7\xee'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00\x1f\x00\x03^\xd6v\x8a\xe7\xee\x00\x00\x07"i\x91\xa4>\xd4Hw`!O\x94`\xb0'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: 274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
DEBUG:__main__:SQN: b'\x00\x03'
Request message: b'\x01\x00\x01\x00\x00\x1f\x00\x03^\xd6v\x8a\xe7\xee\x00\x00\x07"i\x91\xa4>\xd4Hw`!O\x94`\xb0'
Message hash: b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"

DEBUG:__main__:b'\x01\x00\x01\x00\x00\x1f\x00\x03^\xd6v\x8a\xe7\xee\x00\x00\x07"i\x91\xa4>\xd4Hw`!O\x94`\xb0'
DEBUG:__main__:b"'@\x88\xa0\xcd\xe8\xb7$\x15>\xd99j\x94b\x99\xf1\x0c\x19\xc6\xcfY:\x19\xceW\xc5%\x80\xa3-\xcb"
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00s\x00\x03\xb9\x13\xc2T\x19q\x00\x00\x01x3\x8bC\t\xa6\xea\xf9[;\x15j\xdc\xbfi\xb42\x08d}\xa1L\xd5\xcfuW\xa6\x11\xaa\xbc[\xc8\x9a\xdd8xY\x01\xb3L+*\xe2\x02]\xc4\xf8\xf4\x05\xf2b\x97h\xcc\xc0\x9e9\x9cwDO:\x82!\x7f\xbb"\xcd-\x07\xbbs\\\xc9\x01\x95\xe0^\xa2|\xdc}\x95\x1cn\x84\xd0\xd2S\nY\xad}\x85B\x82\xcb\x87'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00s\x00\x03\xb9\x13\xc2T\x19q\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\xd0\xd2S\nY\xad}\x85B\x82\xcb\x87'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b'lst\n274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb\nsuccess\ntest\ntest1'
DEBUG:SiFT_MTP:lst
274088a0cde8b724153ed9396a946299f10c19c6cf593a19ce57c52580a32dcb
success
test
test1
DEBUG:__main__:command_format
DEBUG:__main__:chd
test
INFO:SiFT_MTP:command request init
DEBUG:SiFT_MTP:b'\xf7T\xfd\x8f\x0bC\x8a\x93g\\\x83-\xd2\x0e\x0b}\xfa_L\x89\x8a\x0fq\xf6{ZZ\xcc\x83\x9cf\xd1'
DEBUG:SiFT_MTP:32
INFO:SiFT_MTP:command request function
INFO:SiFT_MTP:command request to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
DEBUG:SiFT_MTP:Message length b'\x00$'
INFO:SiFT_MTP:create request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:message encryption
DEBUG:SiFT_MTP:chd
test
DEBUG:SiFT_MTP:b'\x01\x00\x01\x00\x00$\x00\x04-b.\xee\x03h\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encrypted: b'\xf3\xab\xcdQ\xdc\x04\x19\xb7'
MAC: b'\xe9Q\xc02\x9e\x1b\xf6\xfc\x87\xa7\x07g'nonce b'\x00\x04-b.\xee\x03h'

INFO:SiFT_MTP:encrypted
DEBUG:SiFT_MTP:Full message b'\x01\x00\x01\x00\x00$\x00\x04-b.\xee\x03h\x00\x00\xf3\xab\xcdQ\xdc\x04\x19\xb7\xe9Q\xc02\x9e\x1b\xf6\xfc\x87\xa7\x07g'
INFO:SiFT_MTP:command request sha256
DEBUG:SiFT_MTP:Message hash: eb882b88f299fd5ab3ea7bdaaa1d6fca697c2480160bf0b95a15db8df94273f3
DEBUG:__main__:SQN: b'\x00\x04'
Request message: b'\x01\x00\x01\x00\x00$\x00\x04-b.\xee\x03h\x00\x00\xf3\xab\xcdQ\xdc\x04\x19\xb7\xe9Q\xc02\x9e\x1b\xf6\xfc\x87\xa7\x07g'
Message hash: b'\xeb\x88+\x88\xf2\x99\xfdZ\xb3\xea{\xda\xaa\x1do\xcai|$\x80\x16\x0b\xf0\xb9Z\x15\xdb\x8d\xf9Bs\xf3'

DEBUG:__main__:b'\x01\x00\x01\x00\x00$\x00\x04-b.\xee\x03h\x00\x00\xf3\xab\xcdQ\xdc\x04\x19\xb7\xe9Q\xc02\x9e\x1b\xf6\xfc\x87\xa7\x07g'
DEBUG:__main__:b'\xeb\x88+\x88\xf2\x99\xfdZ\xb3\xea{\xda\xaa\x1do\xcai|$\x80\x16\x0b\xf0\xb9Z\x15\xdb\x8d\xf9Bs\xf3'
INFO:__main__:Message sent!
DEBUG:__main__:Command response: b'\x01\x00\x01\x10\x00\x93\x00\x04\xb9\x13\xc2T\x19q\x00\x00\xe9A_\xc7\x8aR\x86y\x9c\x16\xed\x1d\xc3$t$\x0fg\xab\xbe\xa0\xb3q"\x0f\xc7Gn\xc4\xed\xaf\x04\x98\xe3\xcd\x1cs\xe4\xdb\x8e\xd1\x08\xd9\x9f1\xbe\xa0\xae\x84\xe1+\xe4o\xd3\rp\xea\xe8\xa4\x9cX\xe0!?_\xe5\xbe\xaf\\Z@djf?\xb7\xb8\x1eK\xe9\xe5\xbf\xb0\x14\xa6\xd6\xa5r\xdd]\xc4]\x8a\xef0\x86\xebh\x152\x85\xca\xf6S5vC\xe2U6\xac\xc1\x86\x1b\x83\xe9\xc8!\xbb\x86@C9\xb9@\xab\xc1,\x0b\xd8M'
INFO:SiFT_MTP:command response init
INFO:SiFT_MTP:command response
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x01\x10\x00\x93\x00\x04\xb9\x13\xc2T\x19q\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
INFO:SiFT_MTP:length check
INFO:SiFT_MTP:Checking response mac
DEBUG:SiFT_MTP:b'\x86@C9\xb9@\xab\xc1,\x0b\xd8M'
INFO:SiFT_MTP:decrypt and mac verify
DEBUG:SiFT_MTP:b"chd\neb882b88f299fd5ab3ea7bdaaa1d6fca697c2480160bf0b95a15db8df94273f3\nfailure\n'NoneType' object has no attribute 'strip'"
DEBUG:SiFT_MTP:chd
eb882b88f299fd5ab3ea7bdaaa1d6fca697c2480160bf0b95a15db8df94273f3
failure
'NoneType' object has no attribute 'strip'
DEBUG:__main__:__init__
INFO:__main__:Initialization
DEBUG:__main__:operation
DEBUG:__main__:connect
INFO:__main__:Connection established
DEBUG:__main__:login
INFO:__main__:Starting Login Protocol
INFO:SiFT_MTP:login request init
INFO:SiFT_MTP:create mtp message
DEBUG:SiFT_MTP:Created message: 1652296535796472800
alice
aaa
3411a6da673a077263bd55d220b829f9
INFO:SiFT_MTP:loading pubkey
INFO:SiFT_MTP:login request func
INFO:SiFT_MTP:handle to mtp
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:Mesage length calculation
INFO:SiFT_MTP:login message length calc
DEBUG:SiFT_MTP:Payload length: 62
DEBUG:SiFT_MTP:Login message length: 346
Login message length in bytes: b'\x01Z'
DEBUG:SiFT_MTP:Message length b'\x01Z'
INFO:SiFT_MTP:mtp login request
INFO:SiFT_MTP:create header
INFO:SiFT_MTP:login req encryption
DEBUG:SiFT_MTP:1652296535796472800
alice
aaa
3411a6da673a077263bd55d220b829f9
DEBUG:SiFT_MTP:b'\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00'
INFO:SiFT_MTP:Payload encrypted and Mac calculated
DEBUG:SiFT_MTP:Encryption: 
MAC: b"z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xee"nonce b'\x00\x01\xb0\x84W\xbb\x01o'
tk: b":'\xcfj\x8a\xe5\xe1[\xba\xf44\xc8{\x86p\x9b\x1a\xd9\xfehK\xacT\xdb\xb16\x01\x04|z\xd5\\"
encrypted payload: b'\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*'
INFO:SiFT_MTP:encrypted
INFO:SiFT_MTP:Encrypting TK
DEBUG:SiFT_MTP:Encrypted tk: b"k\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
DEBUG:SiFT_MTP:
mac length: 12
header length: 16
pyl length: 62
ectk len: 256

DEBUG:SiFT_MTP:Full message sent back: b"\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xeek\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
DEBUG:SiFT_MTP:Message from MTP: b"\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xeek\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
DEBUG:SiFT_MTP:TK from MTP: b":'\xcfj\x8a\xe5\xe1[\xba\xf44\xc8{\x86p\x9b\x1a\xd9\xfehK\xacT\xdb\xb16\x01\x04|z\xd5\\"
INFO:SiFT_MTP:sha256 generation
DEBUG:SiFT_MTP:Message hash: 251f087a172df2a29a94a9dbe0808e087e09c3c3c736c225e606568b944e3cce
DEBUG:__main__:Login request: 
Username: alice
Password: aaa
SQN: b'\x00\x01'
Login request message: b"\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xeek\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
Message hash: b'%\x1f\x08z\x17-\xf2\xa2\x9a\x94\xa9\xdb\xe0\x80\x8e\x08~\t\xc3\xc3\xc76\xc2%\xe6\x06V\x8b\x94N<\xce'
My random: 3411a6da673a077263bd55d220b829f9
Temp key: b":'\xcfj\x8a\xe5\xe1[\xba\xf44\xc8{\x86p\x9b\x1a\xd9\xfehK\xacT\xdb\xb16\x01\x04|z\xd5\\"
INFO:__main__:Message sent
DEBUG:__main__:Login response: b"\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xeek\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
INFO:__main__:Response decrypt
DEBUG:__main__:Response: b"\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00\x84\xf9\xdf|\xfe\x9c\xfc\x9e;\xec\x93\xcd\xbb\xc0\xf1f:c\x85\x93\xda\x84\x89\xb7\xafO\x8cY*\xeb\xc5\xc6c\x1c\xc8\x90\x1e\xc9\xe7\xe5\xefD\xbcF\x1cb\xcd\\\xc1$\xf9\x01\xca\x8bE\x95>\xbeQ\xde\xf4*z\xe9'\xa8\x8fP\xce\x97\x82\x05\x1b\xeek\x82<N\xd4\x9a\x91\x1d\xd3 q\x1c\xe1\xdcF\x84\xc5]\x0e`\x07\x1cH\xa7\xca\xcdU\xf4\xa9g\x80bu\r\x13\xd0\x90\xcc\x9d\xd4<\xaaa\xdc\xfa\xb7\x1f+\xac$[i|\xc2\x94,\xdc\x91\xd4l\xc6\xf9.\x92\x00'\x822\x9b\x9eb\xf6\xcd\xb9V!\x80\xbe\x8e\x83`\xfe\x90s\x89\xe5\x15\x03%\xa3\x88\xcd\xe3\xe8\x1b\x06\xa7\x89\xb4\xd0\xab\xc2\x91Aas\xf8\xec\xc6q\xf1\xfe\xac\xd9v*r@Z\xb4\xd4\x8f-\xb5MQ\x08E\x14\xe0pF\x05\x93g\xd4>\x86@\x97\\\xb4\xfcBX$\xbewg\xa6\x9eZ4]y\x00fA\\/\x90\xd6j\x94\x0e\xf0\x944G~Xq_\xcdh3\x8b;s\xd6\xf9l-ib\x9f\x81Y\x9e\xa6\x80\xc5\xf5\xc9\x14si\xc6c!I\x83\xffZ\xcf\xb2\x08f\xdd\xdb\xe8\xa1\xf8\xcf4g\xe2\x9e\x12\x80\x18\xd3\x86\x1dW\xa0wU\xb1.\xf8R\xcc\xddU\x8e\x1d\nW\xa3\x8f\x9aY\xc1\x8a\x9fI\xb3\x9c(.\xd8\x95VK\x8b"
INFO:SiFT_MTP:login response init
INFO:SiFT_MTP:parsing response message
INFO:SiFT_MTP:mtp response init
INFO:SiFT_MTP:mtp response
DEBUG:SiFT_MTP:HEADER: b'\x01\x00\x00\x00\x01Z\x00\x01\xb0\x84W\xbb\x01o\x00\x00'
INFO:SiFT_MTP:check_version
INFO:SiFT_MTP:sqn check
INFO:SiFT_MTP:type check
DEBUG:SiFT_MTP:Expected type: 16
Response type: 0
ERROR:__main__:An error was occurred during the process: 'NoneType' object has no attribute 'decode'
